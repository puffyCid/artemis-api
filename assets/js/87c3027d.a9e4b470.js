"use strict";(self.webpackChunkartemis_docs=self.webpackChunkartemis_docs||[]).push([[9200],{1728:(t,e,i)=>{i.r(e),i.d(e,{assets:()=>o,contentTitle:()=>r,default:()=>p,frontMatter:()=>c,metadata:()=>a,toc:()=>d});var n=i(7624),s=i(2172);const c={sidebar_position:5,description:"Creating a script"},r="Scripts",a={id:"Intro/Scripting/scripts",title:"Scripts",description:"Creating a script",source:"@site/docs/Intro/Scripting/scripts.md",sourceDirName:"Intro/Scripting",slug:"/Intro/Scripting/scripts",permalink:"/artemis-api/docs/Intro/Scripting/scripts",draft:!1,unlisted:!1,editUrl:"https://github.com/puffyCid/artemis-api/tree/main/artemis-docs/docs/Intro/Scripting/scripts.md",tags:[],version:"current",lastUpdatedBy:"puffyCid",lastUpdatedAt:1715224196e3,sidebarPosition:5,frontMatter:{sidebar_position:5,description:"Creating a script"},sidebar:"artemisStart",previous:{title:"Filtering",permalink:"/artemis-api/docs/Intro/Scripting/filterscripts"},next:{title:"Limitations",permalink:"/artemis-api/docs/Intro/Scripting/limitations"}},o={},d=[];function l(t){const e={a:"a",code:"code",h1:"h1",li:"li",p:"p",pre:"pre",ul:"ul",...(0,s.M)(),...t.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(e.h1,{id:"scripts",children:"Scripts"}),"\n",(0,n.jsx)(e.p,{children:"The easiest way to start scripting is to create a Deno project."}),"\n",(0,n.jsxs)(e.ul,{children:["\n",(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.code,{children:"deno init <project name>"})," will create a project in the current directory"]}),"\n"]}),"\n",(0,n.jsxs)(e.p,{children:["The ",(0,n.jsx)(e.a,{href:"https://deno.land/manual@v1.32.4/introduction",children:"deno"})," website contains the\nfull documentation on a Deno project layout. By default the following files are\ncreated for a new project:"]}),"\n",(0,n.jsxs)(e.ul,{children:["\n",(0,n.jsx)(e.li,{children:"deno.jsonc"}),"\n",(0,n.jsx)(e.li,{children:"main.ts"}),"\n",(0,n.jsx)(e.li,{children:"main_test.ts"}),"\n"]}),"\n",(0,n.jsxs)(e.p,{children:["Since we are using a runtime built specifically for forensics and IR none of the\nbuiltin Deno functions are available. All scripts must import the\n",(0,n.jsx)(e.a,{href:"https://github.com/puffyCid/artemis-api",children:"artemis-api"})," modules in order to\neffectively create scripts."]}),"\n",(0,n.jsxs)(e.p,{children:["Remember, since theis is a custom JS runtime, we will only have access the\nvanilla\n",(0,n.jsx)(e.a,{href:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects",children:"JavaScript"}),"\nAPI and the ",(0,n.jsx)(e.a,{href:"https://github.com/puffyCid/artemis-api",children:"artemis-api"})," for scripting"]}),"\n",(0,n.jsx)(e.p,{children:"To import artemis functions into your script, open main.ts and import the\nfunction associated with the artifact you want to parse. For example, to parse\nthe Windows Registry you would import:"}),"\n",(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:"language-typescript",children:'import { getRegistry } from "https://raw.githubusercontent.com/puffycid/artemis-api/master/mod.ts";\n'})}),"\n",(0,n.jsx)(e.p,{children:"If you wanted to parse the Windows Registry and manipulate the parsed data you\nwould import:"}),"\n",(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:"language-typescript",children:'import { getRegistry } from "https://raw.githubusercontent.com/puffycid/artemis-api/master/mod.ts";\nimport { Registry } from "https://raw.githubusercontent.com/puffycid/artemis-api/master/src/windows/registry.ts";\n'})}),"\n",(0,n.jsxs)(e.p,{children:["A list of all exported artemis functions can be found at\n",(0,n.jsx)(e.a,{href:"https://github.com/puffyCid/artemis-api",children:"https://github.com/puffyCid/artemis-api"}),". All artifacts supported by artemis are\ncallable from TypeScrpt. The structured output produced by each artifact is\nlisted in the respective artifact chapter. For example, the structured Registry\ndata format return ",(0,n.jsx)(e.code,{children:"getRegistry"})," is found in the\n",(0,n.jsx)(e.a,{href:"/artemis-api/docs/Artifacts/Windows%20Artfacts/registry",children:"Registry chapter"})]}),"\n",(0,n.jsx)(e.p,{children:"Once we have created and bundled our script. We just need to base64 encode\nbefore providing it to artemis."}),"\n",(0,n.jsx)(e.h1,{id:"toml-collection",children:"TOML Collection"}),"\n",(0,n.jsx)(e.p,{children:"An example TOML collection would like this"}),"\n",(0,n.jsx)(e.pre,{children:(0,n.jsx)(e.code,{className:"language-toml",children:'system = "macos"\n\n[output]\nname = "plist_data"\ndirectory = "./tmp"\nformat = "json"\ncompress = false\nendpoint_id = "6c51b123-1522-4572-9f2a-0bd5abd81b82"\ncollection_id = 1\noutput = "local"\n\n[[artifacts]]\nartifact_name = "script"\n[artifacts.script]\nname = "all_users_plist_files"\n# Parses all plist files in /Users/%\nscript = "Ly8gaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL3B1ZmZ5Y2lkL2FydGVtaXMtYXBpL21hc3Rlci9zcmMvbWFjb3MvcGxpc3QudHMKZnVuY3Rpb24gZ2V0UGxpc3QocGF0aCkgewogIGNvbnN0IGRhdGEgPSBEZW5vLmNvcmUub3BzLmdldF9wbGlzdChwYXRoKTsKICBpZiAoZGF0YSA9PT0gIiIpIHsKICAgIHJldHVybiBudWxsOwogIH0KICBjb25zdCBwbGlzdF9kYXRhID0gSlNPTi5wYXJzZShkYXRhKTsKICByZXR1cm4gcGxpc3RfZGF0YTsKfQoKLy8gaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL3B1ZmZ5Y2lkL2FydGVtaXMtYXBpL21hc3Rlci9zcmMvc3lzdGVtL291dHB1dC50cwpmdW5jdGlvbiBvdXRwdXRSZXN1bHRzKGRhdGEsIGRhdGFfbmFtZSwgb3V0cHV0KSB7CiAgY29uc3Qgb3V0cHV0X3N0cmluZyA9IEpTT04uc3RyaW5naWZ5KG91dHB1dCk7CiAgY29uc3Qgc3RhdHVzID0gRGVuby5jb3JlLm9wcy5vdXRwdXRfcmVzdWx0cygKICAgIGRhdGEsCiAgICBkYXRhX25hbWUsCiAgICBvdXRwdXRfc3RyaW5nCiAgKTsKICByZXR1cm4gc3RhdHVzOwp9CgovLyBodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vcHVmZnljaWQvYXJ0ZW1pcy1hcGkvbWFzdGVyL3NyYy9maWxlc3lzdGVtL2RpcmVjdG9yeS50cwphc3luYyBmdW5jdGlvbiByZWFkRGlyKHBhdGgpIHsKICBjb25zdCBkYXRhID0gSlNPTi5wYXJzZShhd2FpdCBmcy5yZWFkRGlyKHBhdGgpKTsKICByZXR1cm4gZGF0YTsKfQoKLy8gbWFpbi50cwphc3luYyBmdW5jdGlvbiBtYWluKCkgewogIGNvbnN0IHN0YXJ0X3BhdGggPSAiL1VzZXJzIjsKICBjb25zdCBwbGlzdF9maWxlcyA9IFtdOwogIGF3YWl0IHJlY3Vyc2VfZGlyKHBsaXN0X2ZpbGVzLCBzdGFydF9wYXRoKTsKICByZXR1cm4gcGxpc3RfZmlsZXM7Cn0KYXN5bmMgZnVuY3Rpb24gcmVjdXJzZV9kaXIocGxpc3RfZmlsZXMsIHN0YXJ0X3BhdGgpIHsKICBpZiAocGxpc3RfZmlsZXMubGVuZ3RoID4gMjApIHsKICAgIGNvbnN0IG91dCA9IHsKICAgICAgbmFtZTogImFydGVtaXNfcGxpc3QiLAogICAgICBkaXJlY3Rvcnk6ICIuL3RtcCIsCiAgICAgIGZvcm1hdDogImpzb24iIC8qIEpTT04gKi8sCiAgICAgIGNvbXByZXNzOiBmYWxzZSwKICAgICAgZW5kcG9pbnRfaWQ6ICJhbnl0aGluZy1pLXdhbnQiLAogICAgICBjb2xsZWN0aW9uX2lkOiAxLAogICAgICBvdXRwdXQ6ICJsb2NhbCIgLyogTE9DQUwgKi8KICAgIH07CiAgICBjb25zdCBzdGF0dXMgPSBvdXRwdXRSZXN1bHRzKAogICAgICBKU09OLnN0cmluZ2lmeShwbGlzdF9maWxlcyksCiAgICAgICJhcnRlbWlzX2luZm8iLAogICAgICBvdXQKICAgICk7CiAgICBpZiAoIXN0YXR1cykgewogICAgICBjb25zb2xlLmxvZygiQ291bGQgbm90IG91dHB1dCB0byBsb2NhbCBkaXJlY3RvcnkiKTsKICAgIH0KICAgIHBsaXN0X2ZpbGVzID0gW107CiAgfQogIGZvciAoY29uc3QgZW50cnkgb2YgYXdhaXQgcmVhZERpcihzdGFydF9wYXRoKSkgewogICAgY29uc3QgcGxpc3RfcGF0aCA9IGAke3N0YXJ0X3BhdGh9LyR7ZW50cnkuZmlsZW5hbWV9YDsKICAgIGlmIChlbnRyeS5pc19maWxlICYmIGVudHJ5LmZpbGVuYW1lLmVuZHNXaXRoKCJwbGlzdCIpKSB7CiAgICAgIGNvbnN0IGRhdGEgPSBnZXRQbGlzdChwbGlzdF9wYXRoKTsKICAgICAgaWYgKGRhdGEgPT09IG51bGwpIHsKICAgICAgICBjb250aW51ZTsKICAgICAgfQogICAgICBjb25zdCBwbGlzdF9pbmZvID0gewogICAgICAgIHBsaXN0X2NvbnRlbnQ6IGRhdGEsCiAgICAgICAgZmlsZTogcGxpc3RfcGF0aAogICAgICB9OwogICAgICBwbGlzdF9maWxlcy5wdXNoKHBsaXN0X2luZm8pOwogICAgICBjb250aW51ZTsKICAgIH0KICAgIGlmIChlbnRyeS5pc19kaXJlY3RvcnkpIHsKICAgICAgYXdhaXQgcmVjdXJzZV9kaXIocGxpc3RfZmlsZXMsIHBsaXN0X3BhdGgpOwogICAgfQogIH0KfQptYWluKCk7Cg=="\n'})}),"\n",(0,n.jsx)(e.h1,{id:"collection-options",children:"Collection Options"}),"\n",(0,n.jsxs)(e.ul,{children:["\n",(0,n.jsx)(e.li,{children:"name: Name for script"}),"\n",(0,n.jsx)(e.li,{children:"script: Base64 encoded bundled script (JavaScript)"}),"\n"]})]})}function p(t={}){const{wrapper:e}={...(0,s.M)(),...t.components};return e?(0,n.jsx)(e,{...t,children:(0,n.jsx)(l,{...t})}):l(t)}},2172:(t,e,i)=>{i.d(e,{I:()=>a,M:()=>r});var n=i(1504);const s={},c=n.createContext(s);function r(t){const e=n.useContext(c);return n.useMemo((function(){return"function"==typeof t?t(e):{...e,...t}}),[e,t])}function a(t){let e;return e=t.disableParentContext?"function"==typeof t.components?t.components(s):t.components||s:r(t.components),n.createElement(c.Provider,{value:e},t.children)}}}]);