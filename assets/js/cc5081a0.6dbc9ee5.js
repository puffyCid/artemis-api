"use strict";(globalThis.webpackChunkartemis_docs=globalThis.webpackChunkartemis_docs||[]).push([[3568],{28453:(e,t,n)=>{n.d(t,{R:()=>s,x:()=>l});var r=n(96540);const a={},i=r.createContext(a);function s(e){const t=r.useContext(i);return r.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function l(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:s(e.components),r.createElement(i.Provider,{value:t},e.children)}},58785:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>o,contentTitle:()=>l,default:()=>h,frontMatter:()=>s,metadata:()=>r,toc:()=>d});const r=JSON.parse('{"id":"API/Artifacts/macos","title":"macOS","description":"Interact with macOS Artifacts","source":"@site/docs/API/Artifacts/macos.md","sourceDirName":"API/Artifacts","slug":"/API/Artifacts/macos","permalink":"/artemis-api/docs/API/Artifacts/macos","draft":false,"unlisted":false,"editUrl":"https://github.com/puffyCid/artemis-api/tree/main/artemis-docs/docs/API/Artifacts/macos.md","tags":[],"version":"current","lastUpdatedBy":"puffyCid","lastUpdatedAt":1767062193000,"frontMatter":{"description":"Interact with macOS Artifacts"},"sidebar":"artemisAPI","previous":{"title":"Linux","permalink":"/artemis-api/docs/API/Artifacts/linux"},"next":{"title":"Unix","permalink":"/artemis-api/docs/API/Artifacts/unix"}}');var a=n(74848),i=n(28453);const s={description:"Interact with macOS Artifacts"},l="macOS",o={},d=[{value:"getUsers(path) -&gt; Users[] | MacosError",id:"getuserspath---users--macoserror",level:3},{value:"getGroup(path) -&gt; Groups[] | MacosError",id:"getgrouppath---groups--macoserror",level:3},{value:"parseAlias(data) -&gt; Alias | MacosError",id:"parsealiasdata---alias--macoserror",level:3},{value:"getEmond(path) -&gt; Emond[] | MacosError",id:"getemondpath---emond--macoserror",level:3},{value:"getExecpolicy(path) -&gt; ExecPolicy[] | MacosError",id:"getexecpolicypath---execpolicy--macoserror",level:3},{value:"firewallStatus(alt_path) -&gt; Firewall | MacosError",id:"firewallstatusalt_path---firewall--macoserror",level:3},{value:"getFsevents(path) -&gt; Fsevents[] | MacosError",id:"getfseventspath---fsevents--macoserror",level:3},{value:"getLaunchdDaemons() -&gt; Launchd[] | MacosError",id:"getlaunchddaemons---launchd--macoserror",level:3},{value:"getLaunchdAgents() -&gt; Launchd[] | MacosError",id:"getlaunchdagents---launchd--macoserror",level:3},{value:"getLoginitems(path) -&gt; LoginItems[] | MacosError",id:"getloginitemspath---loginitems--macoserror",level:3},{value:"getMacho(path) -&gt; MachoInfo[] | MacosError",id:"getmachopath---machoinfo--macoserror",level:3},{value:"getPlist(path or Uint8Array) -&gt; Record&lt;string, unknown&gt; | Uint8Array | Record&lt;string, unknown&gt;[] | MacosError",id:"getplistpath-or-uint8array---recordstring-unknown--uint8array--recordstring-unknown--macoserror",level:3},{value:"passwordPolicy(alt_path) -&gt; PasswordPolicy[] | MacosError",id:"passwordpolicyalt_path---passwordpolicy--macoserror",level:3},{value:"getUnifiedLog(path, archive_path) -&gt; UnifiedLog[] | MacosError",id:"getunifiedlogpath-archive_path---unifiedlog--macoserror",level:3},{value:"parseRequirementBlob(data) -&gt; SingleRequirement | MacosError",id:"parserequirementblobdata---singlerequirement--macoserror",level:3},{value:"listApps() -&gt; Applications[] | MacosError",id:"listapps---applications--macoserror",level:3},{value:"scanApps() -&gt; Applications[] | MacosError",id:"scanapps---applications--macoserror",level:3},{value:"dockTiles() -&gt; Applications[] | MacosError",id:"docktiles---applications--macoserror",level:3},{value:"getPackages(glob_path) -&gt; HomebrewReceipt[]",id:"getpackagesglob_path---homebrewreceipt",level:3},{value:"getCasks(glob_path) -&gt; HomebrewFormula[]",id:"getcasksglob_path---homebrewformula",level:3},{value:"getHomebrewInfo() -&gt; HomebrewData",id:"gethomebrewinfo---homebrewdata",level:3},{value:"wifiNetworks() -&gt; Wifi[]",id:"wifinetworks---wifi",level:3},{value:"getSudoLogs() -&gt; UnifiedLog[]",id:"getsudologs---unifiedlog",level:3},{value:"parseBom(path) -&gt; Bom",id:"parsebompath---bom",level:3},{value:"systemExtensions(alt_path) -&gt; SystemExtension[]",id:"systemextensionsalt_path---systemextension",level:3},{value:"queryTccDb(alt_db) -&gt; TccValues[] | MacosError",id:"querytccdbalt_db---tccvalues--macoserror",level:3},{value:"Parsing macOS Spotlight",id:"parsing-macos-spotlight",level:3},{value:"setupSpotlightParser(glob_path) -&gt; StoreMeta | MacosError",id:"setupspotlightparserglob_path---storemeta--macoserror",level:4},{value:"getSpotlight(meta, store_file, offset) -&gt; StoreMeta | MacosError",id:"getspotlightmeta-store_file-offset---storemeta--macoserror",level:4},{value:"getXprotectDefinitions(alt_path) -&gt; XprotectEntries[] | MacosError",id:"getxprotectdefinitionsalt_path---xprotectentries--macoserror",level:3},{value:"luluRules(alt_path) -&gt; LuluRules | MacosError",id:"lulurulesalt_path---lulurules--macoserror",level:3},{value:"munkiApplicationUsage(db) -&gt; MunkiApplicationUsage[] | MacosError",id:"munkiapplicationusagedb---munkiapplicationusage--macoserror",level:3},{value:"quarantineEvents(alt_file) -&gt; MacosQuarantine[] | MacosError",id:"quarantineeventsalt_file---macosquarantine--macoserror",level:3},{value:"parseBiome(app_focus_only, alt_file) -&gt; Biome[]",id:"parsebiomeapp_focus_only-alt_file---biome",level:3},{value:"gatekeeperEntries(db) -&gt; GatekeeperEntries[] | MacosError",id:"gatekeeperentriesdb---gatekeeperentries--macoserror",level:3},{value:"logonsMacos(path, archive_path) -&gt; LogonMacos[] | MacosError",id:"logonsmacospath-archive_path---logonmacos--macoserror",level:3},{value:"parseCookies(path) -&gt; Cookie[] | MacosError",id:"parsecookiespath---cookie--macoserror",level:3},{value:"Safari Browser Class",id:"safari-browser-class",level:3},{value:"history(offset, limit) -&gt; SafariHistory[]",id:"historyoffset-limit---safarihistory",level:4},{value:"downloads() -&gt; SafariDownloads[]",id:"downloads---safaridownloads",level:4},{value:"favicons(offset, limit) -&gt; SafariFavicons[]",id:"faviconsoffset-limit---safarifavicons",level:4},{value:"bookmarks() -&gt; SafariBookmark[]",id:"bookmarks---safaribookmark",level:4},{value:"cookies() -&gt; Cookie[]",id:"cookies---cookie",level:4},{value:"extensions() -&gt; SafariExtensions[]",id:"extensions---safariextensions",level:4},{value:"retrospect(output) -&gt; void",id:"retrospectoutput---void",level:4},{value:"parseSystemStats(alt_file) -&gt; SystemStats[] | MacosError",id:"parsesystemstatsalt_file---systemstats--macoserror",level:3}];function c(e){const t={a:"a",admonition:"admonition",br:"br",code:"code",h1:"h1",h3:"h3",h4:"h4",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(t.header,{children:(0,a.jsx)(t.h1,{id:"macos",children:"macOS"})}),"\n",(0,a.jsx)(t.p,{children:"These functions can be used to pull data related to macOS artifacts."}),"\n",(0,a.jsxs)(t.p,{children:["You can access these functions by using git to clone the API ",(0,a.jsx)(t.a,{href:"https://github.com/puffyCid/artemis-api",children:"TypeScript bindings"}),".",(0,a.jsx)(t.br,{}),"\n","Then you may import them into your TypeScript code."]}),"\n",(0,a.jsx)(t.p,{children:"For example:"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-typescript",children:'import { listApps } from "./artemis-api/mod";\n\nfunction main() {\n  const results = listApps();\n  console.log(JSON.stringify(results));\n}\n\nmain();\n'})}),"\n",(0,a.jsx)(t.h3,{id:"getuserspath---users--macoserror",children:"getUsers(path) -> Users[] | MacosError"}),"\n",(0,a.jsx)(t.p,{children:"Return all local users on macOS system. Can provide an optional alternative path\nto directory containing users. Otherwise will use default path on system\n/var/db/dslocal/nodes/Default/users"}),"\n",(0,a.jsxs)(t.table,{children:[(0,a.jsx)(t.thead,{children:(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.th,{children:"Param"}),(0,a.jsx)(t.th,{children:"Type"}),(0,a.jsx)(t.th,{children:"Description"})]})}),(0,a.jsx)(t.tbody,{children:(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"path"}),(0,a.jsx)(t.td,{children:"string"}),(0,a.jsx)(t.td,{children:"Optional alternative path to users directory"})]})})]}),"\n",(0,a.jsx)(t.h3,{id:"getgrouppath---groups--macoserror",children:"getGroup(path) -> Groups[] | MacosError"}),"\n",(0,a.jsx)(t.p,{children:"Return all local groups on macOS system. Can provide an optional alternative path\nto directory containing groups. Otherwise will use default path on system\n/var/db/dslocal/nodes/Default/groups"}),"\n",(0,a.jsxs)(t.table,{children:[(0,a.jsx)(t.thead,{children:(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.th,{children:"Param"}),(0,a.jsx)(t.th,{children:"Type"}),(0,a.jsx)(t.th,{children:"Description"})]})}),(0,a.jsx)(t.tbody,{children:(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"path"}),(0,a.jsx)(t.td,{children:"string"}),(0,a.jsx)(t.td,{children:"Optional alternative path to groups directory"})]})})]}),"\n",(0,a.jsx)(t.h3,{id:"parsealiasdata---alias--macoserror",children:"parseAlias(data) -> Alias | MacosError"}),"\n",(0,a.jsxs)(t.p,{children:["Parse macOS ",(0,a.jsx)(t.a,{href:"https://en.wikipedia.org/wiki/Alias_(Mac_OS)",children:"alias"})," data. Alias\nfiles are a legacy shortcut format. May be encountered in plist files such as\nthe firewall plist file."]}),"\n",(0,a.jsxs)(t.table,{children:[(0,a.jsx)(t.thead,{children:(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.th,{children:"Param"}),(0,a.jsx)(t.th,{children:"Type"}),(0,a.jsx)(t.th,{children:"Description"})]})}),(0,a.jsx)(t.tbody,{children:(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"data"}),(0,a.jsx)(t.td,{children:"Uint8Array"}),(0,a.jsx)(t.td,{children:"Raw alias bytes"})]})})]}),"\n",(0,a.jsx)(t.h3,{id:"getemondpath---emond--macoserror",children:"getEmond(path) -> Emond[] | MacosError"}),"\n",(0,a.jsxs)(t.p,{children:["Get all ",(0,a.jsx)(t.a,{href:"/artemis-api/docs/Artifacts/macOS%20Artifacts/emond",children:"Emond"})," rules on macOS. FYI\nEmond was removed on Ventura. Can provide an optional alternative path to\ndirectory containing emond rules. Otherwise will parse emond config on system to\ntry to find rules"]}),"\n",(0,a.jsxs)(t.table,{children:[(0,a.jsx)(t.thead,{children:(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.th,{children:"Param"}),(0,a.jsx)(t.th,{children:"Type"}),(0,a.jsx)(t.th,{children:"Description"})]})}),(0,a.jsx)(t.tbody,{children:(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"path"}),(0,a.jsx)(t.td,{children:"String"}),(0,a.jsx)(t.td,{children:"Optional alternative path to emond rules"})]})})]}),"\n",(0,a.jsx)(t.h3,{id:"getexecpolicypath---execpolicy--macoserror",children:"getExecpolicy(path) -> ExecPolicy[] | MacosError"}),"\n",(0,a.jsx)(t.p,{children:"Parse the ExecPolicy sqlite database on macOS. Can provide an optional\nalternative path to ExecPolicy database. Otherwise will parse default database\non system at /var/db/SystemPolicyConfiguration/ExecPolicy"}),"\n",(0,a.jsxs)(t.table,{children:[(0,a.jsx)(t.thead,{children:(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.th,{children:"Param"}),(0,a.jsx)(t.th,{children:"Type"}),(0,a.jsx)(t.th,{children:"Description"})]})}),(0,a.jsx)(t.tbody,{children:(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"path"}),(0,a.jsx)(t.td,{children:"String"}),(0,a.jsx)(t.td,{children:"Optional alternative path to ExecPolicy database"})]})})]}),"\n",(0,a.jsx)(t.h3,{id:"firewallstatusalt_path---firewall--macoserror",children:"firewallStatus(alt_path) -> Firewall | MacosError"}),"\n",(0,a.jsx)(t.p,{children:"Return firewall information and status on macOS. Can provide an optional path to\ncom.apple.alf.plist, otherwise will use /Library/Preferences/com.apple.alf.plist"}),"\n",(0,a.jsxs)(t.table,{children:[(0,a.jsx)(t.thead,{children:(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.th,{children:"Param"}),(0,a.jsx)(t.th,{children:"Type"}),(0,a.jsx)(t.th,{children:"Description"})]})}),(0,a.jsx)(t.tbody,{children:(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"alt_path"}),(0,a.jsx)(t.td,{children:"String"}),(0,a.jsx)(t.td,{children:"Alternative full path to the com.apple.alf.plist file"})]})})]}),"\n",(0,a.jsx)(t.h3,{id:"getfseventspath---fsevents--macoserror",children:"getFsevents(path) -> Fsevents[] | MacosError"}),"\n",(0,a.jsx)(t.p,{children:"Parse macOS FsEvents from provided file."}),"\n",(0,a.jsxs)(t.table,{children:[(0,a.jsx)(t.thead,{children:(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.th,{children:"Param"}),(0,a.jsx)(t.th,{children:"Type"}),(0,a.jsx)(t.th,{children:"Description"})]})}),(0,a.jsx)(t.tbody,{children:(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"path"}),(0,a.jsx)(t.td,{children:"String"}),(0,a.jsx)(t.td,{children:"Full path to the FsEvents file"})]})})]}),"\n",(0,a.jsx)(t.h3,{id:"getlaunchddaemons---launchd--macoserror",children:"getLaunchdDaemons() -> Launchd[] | MacosError"}),"\n",(0,a.jsx)(t.p,{children:"Return all Launch daemons on macOS"}),"\n",(0,a.jsx)(t.h3,{id:"getlaunchdagents---launchd--macoserror",children:"getLaunchdAgents() -> Launchd[] | MacosError"}),"\n",(0,a.jsx)(t.p,{children:"Return all Launch agents on macOS"}),"\n",(0,a.jsx)(t.h3,{id:"getloginitemspath---loginitems--macoserror",children:"getLoginitems(path) -> LoginItems[] | MacosError"}),"\n",(0,a.jsx)(t.p,{children:"Return all LoginItems on macOS. Can provide an optional alternative path to a\nLoginItem file (.btm). Otherwise will parse default default locations for\nLoginItems"}),"\n",(0,a.jsxs)(t.table,{children:[(0,a.jsx)(t.thead,{children:(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.th,{children:"Param"}),(0,a.jsx)(t.th,{children:"Type"}),(0,a.jsx)(t.th,{children:"Description"})]})}),(0,a.jsx)(t.tbody,{children:(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"path"}),(0,a.jsx)(t.td,{children:"String"}),(0,a.jsx)(t.td,{children:"Optional alternative path to LoginItem file"})]})})]}),"\n",(0,a.jsx)(t.h3,{id:"getmachopath---machoinfo--macoserror",children:"getMacho(path) -> MachoInfo[] | MacosError"}),"\n",(0,a.jsx)(t.p,{children:"Parse a macho file and return metadata about the binary."}),"\n",(0,a.jsxs)(t.table,{children:[(0,a.jsx)(t.thead,{children:(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.th,{children:"Param"}),(0,a.jsx)(t.th,{children:"Type"}),(0,a.jsx)(t.th,{children:"Description"})]})}),(0,a.jsx)(t.tbody,{children:(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"path"}),(0,a.jsx)(t.td,{children:"string"}),(0,a.jsx)(t.td,{children:"Path to macho binary"})]})})]}),"\n",(0,a.jsx)(t.h3,{id:"getplistpath-or-uint8array---recordstring-unknown--uint8array--recordstring-unknown--macoserror",children:"getPlist(path or Uint8Array) -> Record<string, unknown> | Uint8Array | Record<string, unknown>[] | MacosError"}),"\n",(0,a.jsx)(t.p,{children:"Parse a plist file. Supports parsing a provide plist file path or the raw bytes\nof plist data. Sometimes a plist file may contain another base64 encoded plist.\nThis function can parse the raw plist bytes."}),"\n",(0,a.jsxs)(t.table,{children:[(0,a.jsx)(t.thead,{children:(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.th,{children:"Param"}),(0,a.jsx)(t.th,{children:"Type"}),(0,a.jsx)(t.th,{children:"Description"})]})}),(0,a.jsx)(t.tbody,{children:(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"path or Uint8Array"}),(0,a.jsx)(t.td,{children:"string or Uint8Array"}),(0,a.jsx)(t.td,{children:"Path to plist file or raw plist bytes"})]})})]}),"\n",(0,a.jsx)(t.h3,{id:"passwordpolicyalt_path---passwordpolicy--macoserror",children:"passwordPolicy(alt_path) -> PasswordPolicy[] | MacosError"}),"\n",(0,a.jsx)(t.p,{children:"Get password policies on macOS. Will parse plist file at\n/var/db/dslocal/nodes/Default/config/shadowhash.plist. You may also provide an\noptional alternative path to the shadowhash.plist file."}),"\n",(0,a.jsxs)(t.table,{children:[(0,a.jsx)(t.thead,{children:(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.th,{children:"Param"}),(0,a.jsx)(t.th,{children:"Type"}),(0,a.jsx)(t.th,{children:"Description"})]})}),(0,a.jsx)(t.tbody,{children:(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"alt_path"}),(0,a.jsx)(t.td,{children:"String"}),(0,a.jsx)(t.td,{children:"Optional alternative path to shadowhash.plist file"})]})})]}),"\n",(0,a.jsx)(t.h3,{id:"getunifiedlogpath-archive_path---unifiedlog--macoserror",children:"getUnifiedLog(path, archive_path) -> UnifiedLog[] | MacosError"}),"\n",(0,a.jsx)(t.p,{children:"Parse a single UnifiedLog file (.tracev3) on macOS. Typically found at:"}),"\n",(0,a.jsxs)(t.ul,{children:["\n",(0,a.jsx)(t.li,{children:"/private/var/db/diagnostics/Persist"}),"\n",(0,a.jsx)(t.li,{children:"/private/var/db/diagnostics/Signpost"}),"\n",(0,a.jsx)(t.li,{children:"/private/var/db/diagnostics/HighVolume"}),"\n",(0,a.jsx)(t.li,{children:"/private/var/db/diagnostics/Special"}),"\n"]}),"\n",(0,a.jsx)(t.p,{children:"You may also specify an optional logarchive style directory containing the\nUnified Log metadata (UUID directories, timesync, and dsc directory). Otherwise\nartemis will parse their default locations."}),"\n",(0,a.jsxs)(t.table,{children:[(0,a.jsx)(t.thead,{children:(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.th,{children:"Param"}),(0,a.jsx)(t.th,{children:"Type"}),(0,a.jsx)(t.th,{children:"Description"})]})}),(0,a.jsxs)(t.tbody,{children:[(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"path"}),(0,a.jsx)(t.td,{children:"string"}),(0,a.jsx)(t.td,{children:"Path to .tracev3 file"})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"archive_path"}),(0,a.jsx)(t.td,{children:"string"}),(0,a.jsx)(t.td,{children:"Optional path to a logarchive style directory containing Unified Log metadata"})]})]})]}),"\n",(0,a.jsx)(t.h3,{id:"parserequirementblobdata---singlerequirement--macoserror",children:"parseRequirementBlob(data) -> SingleRequirement | MacosError"}),"\n",(0,a.jsx)(t.p,{children:"Parse the Requirement Blob from raw codesigning bytes. This part of Apple's\nCodeSigning framework. This data can be found in macho binaries and also plist\nfiles."}),"\n",(0,a.jsxs)(t.table,{children:[(0,a.jsx)(t.thead,{children:(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.th,{children:"Param"}),(0,a.jsx)(t.th,{children:"Type"}),(0,a.jsx)(t.th,{children:"Description"})]})}),(0,a.jsx)(t.tbody,{children:(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"data"}),(0,a.jsx)(t.td,{children:"Uint8Array"}),(0,a.jsx)(t.td,{children:"Raw bytes associated with requirement blob"})]})})]}),"\n",(0,a.jsx)(t.h3,{id:"listapps---applications--macoserror",children:"listApps() -> Applications[] | MacosError"}),"\n",(0,a.jsx)(t.p,{children:"Return a simple Application listing. Searches user installed Apps, System Apps,\ndefault Homebrew paths:"}),"\n",(0,a.jsxs)(t.ul,{children:["\n",(0,a.jsx)(t.li,{children:"/usr/local/Cellar"}),"\n",(0,a.jsx)(t.li,{children:"/opt/homebrew/Cellar"}),"\n"]}),"\n",(0,a.jsx)(t.p,{children:"Use scanApps() if you want to scan the entire filesystem for Apps"}),"\n",(0,a.jsx)(t.h3,{id:"scanapps---applications--macoserror",children:"scanApps() -> Applications[] | MacosError"}),"\n",(0,a.jsx)(t.p,{children:"Scans the entire filesystem under /System/ and tries to parse all Applications."}),"\n",(0,a.jsx)(t.p,{children:"Includes embedded Apps, Frameworks, and any file that ends with\n%/Contents/Info.plist"}),"\n",(0,a.jsx)(t.p,{children:"Use listApps() if you a simpler Application listing"}),"\n",(0,a.jsx)(t.h3,{id:"docktiles---applications--macoserror",children:"dockTiles() -> Applications[] | MacosError"}),"\n",(0,a.jsxs)(t.p,{children:["Scans the entire filesystem under /System looking for Applications that use\nDockTile persistence. See ",(0,a.jsx)(t.a,{href:"https://theevilbit.github.io/beyond/beyond_0032/",children:"https://theevilbit.github.io/beyond/beyond_0032/"})," for\ndetails on Dock Tile PlugIns"]}),"\n",(0,a.jsx)(t.p,{children:"Includes embedded Apps, Frameworks, and any file that ends with\n%/Contents/Info.plist"}),"\n",(0,a.jsx)(t.h3,{id:"getpackagesglob_path---homebrewreceipt",children:"getPackages(glob_path) -> HomebrewReceipt[]"}),"\n",(0,a.jsxs)(t.p,{children:["Get Homebrew packages on the system. Does ",(0,a.jsx)(t.strong,{children:"not"})," include Casks.",(0,a.jsx)(t.br,{}),"\n","Use getHomebrewInfo() to get all packages and Casks."]}),"\n",(0,a.jsx)(t.p,{children:"By default this function will search for all packages at:"}),"\n",(0,a.jsxs)(t.ul,{children:["\n",(0,a.jsx)(t.li,{children:"/opt/homebrew/Cellar"}),"\n",(0,a.jsx)(t.li,{children:"/usr/local/Cellar"}),"\n"]}),"\n",(0,a.jsxs)(t.table,{children:[(0,a.jsx)(t.thead,{children:(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.th,{children:"Param"}),(0,a.jsx)(t.th,{children:"Type"}),(0,a.jsx)(t.th,{children:"Description"})]})}),(0,a.jsx)(t.tbody,{children:(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"glob_path"}),(0,a.jsx)(t.td,{children:"string"}),(0,a.jsx)(t.td,{children:"Optional alternative glob path to use"})]})})]}),"\n",(0,a.jsx)(t.h3,{id:"getcasksglob_path---homebrewformula",children:"getCasks(glob_path) -> HomebrewFormula[]"}),"\n",(0,a.jsxs)(t.p,{children:["Get Homebrew Casks on the system. Does ",(0,a.jsx)(t.strong,{children:"not"})," include packages.",(0,a.jsx)(t.br,{}),"\n","Use getHomebrewInfo() to get all packages and Casks."]}),"\n",(0,a.jsx)(t.p,{children:"By default this function will search for all packages at:"}),"\n",(0,a.jsxs)(t.ul,{children:["\n",(0,a.jsx)(t.li,{children:"/opt/homebrew/Caskroom"}),"\n",(0,a.jsx)(t.li,{children:"/usr/local/Caskroom"}),"\n"]}),"\n",(0,a.jsxs)(t.table,{children:[(0,a.jsx)(t.thead,{children:(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.th,{children:"Param"}),(0,a.jsx)(t.th,{children:"Type"}),(0,a.jsx)(t.th,{children:"Description"})]})}),(0,a.jsx)(t.tbody,{children:(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"glob_path"}),(0,a.jsx)(t.td,{children:"string"}),(0,a.jsx)(t.td,{children:"Optional alternative glob path to use"})]})})]}),"\n",(0,a.jsx)(t.h3,{id:"gethomebrewinfo---homebrewdata",children:"getHomebrewInfo() -> HomebrewData"}),"\n",(0,a.jsx)(t.p,{children:"Get Homebrew packages and Casks on the system. Searches for Homebrew data at:"}),"\n",(0,a.jsxs)(t.ul,{children:["\n",(0,a.jsx)(t.li,{children:"/opt/homebrew"}),"\n",(0,a.jsx)(t.li,{children:"/usr/local"}),"\n"]}),"\n",(0,a.jsx)(t.h3,{id:"wifinetworks---wifi",children:"wifiNetworks() -> Wifi[]"}),"\n",(0,a.jsx)(t.p,{children:"Get list of joined Wifi networks on macOS. Requires root access."}),"\n",(0,a.jsx)(t.p,{children:"By default it will try to parse WiFi networks at\n/Library/Preferences/com.apple.wifi.known-networks.plist."}),"\n",(0,a.jsx)(t.p,{children:"You may also provide an optional alternative path to\ncom.apple.wifi.known-networks.plist."}),"\n",(0,a.jsxs)(t.table,{children:[(0,a.jsx)(t.thead,{children:(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.th,{children:"Param"}),(0,a.jsx)(t.th,{children:"Type"}),(0,a.jsx)(t.th,{children:"Description"})]})}),(0,a.jsx)(t.tbody,{children:(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"alt_path"}),(0,a.jsx)(t.td,{children:"String"}),(0,a.jsx)(t.td,{children:"Optional alternative path to com.apple.wifi.known-networks.plist file"})]})})]}),"\n",(0,a.jsx)(t.h3,{id:"getsudologs---unifiedlog",children:"getSudoLogs() -> UnifiedLog[]"}),"\n",(0,a.jsx)(t.p,{children:"Parse the UnifiedLogs and extract entries related to sudo activity."}),"\n",(0,a.jsx)(t.h3,{id:"parsebompath---bom",children:"parseBom(path) -> Bom"}),"\n",(0,a.jsxs)(t.p,{children:["Parse Bill of Materials (BOM) files. BOM files are created whenever the macOS\nInstaller is used to install an application.",(0,a.jsx)(t.br,{}),"\n","BOM files track what files were created by the Installer. It is commonly used to\nensure files are removed when the application is uninstalled. This function will\nalso try to parse the plist receipt associated with the BOM file (if found in\nsame directory)."]}),"\n",(0,a.jsx)(t.p,{children:"BOM files are located at /var/db/receipts/*.bom"}),"\n",(0,a.jsxs)(t.table,{children:[(0,a.jsx)(t.thead,{children:(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.th,{children:"Param"}),(0,a.jsx)(t.th,{children:"Type"}),(0,a.jsx)(t.th,{children:"Description"})]})}),(0,a.jsx)(t.tbody,{children:(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"path"}),(0,a.jsx)(t.td,{children:"string"}),(0,a.jsx)(t.td,{children:"Path to BOM file"})]})})]}),"\n",(0,a.jsx)(t.h3,{id:"systemextensionsalt_path---systemextension",children:"systemExtensions(alt_path) -> SystemExtension[]"}),"\n",(0,a.jsx)(t.p,{children:"Get list of macOS System Extensions. By default artemis will try to extract\ninstalled extensions at /Library/SystemExtensions/db.plist."}),"\n",(0,a.jsx)(t.p,{children:"However, you may also provide an optional alternative path to db.plist."}),"\n",(0,a.jsxs)(t.table,{children:[(0,a.jsx)(t.thead,{children:(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.th,{children:"Param"}),(0,a.jsx)(t.th,{children:"Type"}),(0,a.jsx)(t.th,{children:"Description"})]})}),(0,a.jsx)(t.tbody,{children:(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"alt_path"}),(0,a.jsx)(t.td,{children:"String"}),(0,a.jsx)(t.td,{children:"Optional alternative path to db.plist file"})]})})]}),"\n",(0,a.jsx)(t.h3,{id:"querytccdbalt_db---tccvalues--macoserror",children:"queryTccDb(alt_db) -> TccValues[] | MacosError"}),"\n",(0,a.jsxs)(t.p,{children:["Query all TCC.db files on the system. TCC.db contains granted permissions for\napplications.",(0,a.jsx)(t.br,{}),"\n","An optional path to the TCC.db can be provided. Otherwise will parse all user\nand System TCC.db files."]}),"\n",(0,a.jsxs)(t.table,{children:[(0,a.jsx)(t.thead,{children:(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.th,{children:"Param"}),(0,a.jsx)(t.th,{children:"Type"}),(0,a.jsx)(t.th,{children:"Description"})]})}),(0,a.jsx)(t.tbody,{children:(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"alt_db"}),(0,a.jsx)(t.td,{children:"string"}),(0,a.jsx)(t.td,{children:"Optional path to TCC.db file"})]})})]}),"\n",(0,a.jsx)(t.h3,{id:"parsing-macos-spotlight",children:"Parsing macOS Spotlight"}),"\n",(0,a.jsx)(t.h4,{id:"setupspotlightparserglob_path---storemeta--macoserror",children:"setupSpotlightParser(glob_path) -> StoreMeta | MacosError"}),"\n",(0,a.jsxs)(t.p,{children:["Collect and setup the required data needed to parse the macOS Spotlight\ndatabase.",(0,a.jsx)(t.br,{}),"\n","This function must be called before a user can parse the Spotlight database\nusing the API."]}),"\n",(0,a.jsxs)(t.p,{children:["The glob_path should point to the directory containing the Spotlight database\nfiles.",(0,a.jsx)(t.br,{}),"\n","The primary Spotlight database can be found at:\n/System/Volumes/Data/.Spotlight-V100/Store-V*/*/*",(0,a.jsx)(t.br,{}),"\n","Would return something like:\n/System/Volumes/Data/.Spotlight-V100/Store-V3/123-445566-778-12384/*"]}),"\n",(0,a.jsxs)(t.table,{children:[(0,a.jsx)(t.thead,{children:(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.th,{children:"Param"}),(0,a.jsx)(t.th,{children:"Type"}),(0,a.jsx)(t.th,{children:"Description"})]})}),(0,a.jsx)(t.tbody,{children:(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"glob_path"}),(0,a.jsx)(t.td,{children:"string"}),(0,a.jsx)(t.td,{children:"Glob path to a directory containing the Spotlight Database files"})]})})]}),"\n",(0,a.jsx)(t.h4,{id:"getspotlightmeta-store_file-offset---storemeta--macoserror",children:"getSpotlight(meta, store_file, offset) -> StoreMeta | MacosError"}),"\n",(0,a.jsxs)(t.p,{children:["Parse the macOS Spotlight database. The database can potentially return a large\namount of data (5+GBs).",(0,a.jsx)(t.br,{}),"\n","To prevent excessive memory usage, this function will parse the database in\nblocks (chunks)."]}),"\n",(0,a.jsxs)(t.p,{children:["It will parse ",(0,a.jsx)(t.strong,{children:"10"})," blocks at a time before returning the results. The\n",(0,a.jsx)(t.code,{children:"StoreMeta"})," value obtained from setupSpotlightParser, contains the ",(0,a.jsx)(t.strong,{children:"TOTAL"}),"\namount of blocks in the Spotlight database! You must loop through the blocks and\ntrack what block offset the parser should start at!"]}),"\n",(0,a.jsxs)(t.p,{children:["If you want to the parser to start at the beginning of the Spotlight database,\nprovide an offset of zero (0). Once the parser returns data, your next offset\nwill now be ten (10) because it parsed ",(0,a.jsx)(t.strong,{children:"10"})," blocks starting at zero (0-9)."]}),"\n",(0,a.jsxs)(t.admonition,{type:"info",children:[(0,a.jsxs)(t.p,{children:['Spotlight organizes data in "blocks". Think of blocks as containers that contain 1 or more Spotlight entries.',(0,a.jsx)(t.br,{}),"\n","Parsing 10 blocks does ",(0,a.jsx)(t.strong,{children:"not"})," mean you are only getting 10 entries."]}),(0,a.jsxs)(t.p,{children:["Each block will typically contain ~50 to ~300 entries!",(0,a.jsx)(t.br,{}),"\n","By getting 10 blocks you will be getting between ~500 to ~3000 entries!"]})]}),"\n",(0,a.jsxs)(t.p,{children:["Finally, you must provide the full path to the Spotlight database file\n(store.db). This is typically found in in the directory provided to\n",(0,a.jsx)(t.code,{children:"setupSpotlightParser"}),(0,a.jsx)(t.br,{}),"\n","(ex:\n/System/Volumes/Data/.Spotlight-V100/Store-V3/123-445566-778-12384/store.db)"]}),"\n",(0,a.jsxs)(t.p,{children:["In order to parse Spotlight data you must have ",(0,a.jsx)(t.strong,{children:"root"})," permissions"]}),"\n",(0,a.jsxs)(t.table,{children:[(0,a.jsx)(t.thead,{children:(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.th,{children:"Param"}),(0,a.jsx)(t.th,{children:"Type"}),(0,a.jsx)(t.th,{children:"Description"})]})}),(0,a.jsxs)(t.tbody,{children:[(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"meta"}),(0,a.jsx)(t.td,{children:"StoreMeta"}),(0,a.jsx)(t.td,{children:"Spotlight metadata obtained from setupSpotlightParser"})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"store_file"}),(0,a.jsx)(t.td,{children:"string"}),(0,a.jsx)(t.td,{children:"Full path to the store.db file"})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"offset"}),(0,a.jsx)(t.td,{children:"number"}),(0,a.jsx)(t.td,{children:"Offset to start parsing the Spotlight database"})]})]})]}),"\n",(0,a.jsx)(t.p,{children:'An example script is below that will show all Spotlight entries that contain the string "Downloads" or ".pkg".'}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-typescript",children:'import { getSpotlight, setupSpotlightParser } from "./artemis-api/mod";\nimport { MacosError } from "./artemis-api/src/macos/errors";\nimport { glob } from "./artemis-api/src/filesystem/files";\nimport { FileError } from "./artemis-api/src/filesystem/errors";\n\nfunction main() {\n    // Glob to our primary Spotlight database\n    const glob_path = "/System/Volumes/Data/.Spotlight-V100/Store-V*/*/*";\n    const values = glob(glob_path);\n    if (values instanceof FileError) {\n        console.error(values);\n        return;\n    }\n\n    let store = "";\n    // We need the full path to the store.db\n    for (const value of values) {\n        if (value.filename == "store.db") {\n            store = value.full_path;\n            break;\n        }\n    }\n\n    if (store === "") {\n      console.error("Failed to find store.db");\n      return;\n    }\n\n    // Get some initial metadata that we will need later\n    const meta = setupSpotlightParser("/System/Volumes/Data/.Spotlight-V100/Store-V*/*/*");\n    if (meta instanceof MacosError) {\n        console.error(meta);\n        return;\n    }\n\n    let offset = 0;\n    // To avoid high memory usage we can only parse 10 blocks of Spotlight data at time\n    // We can determine how many total blocks there are by viewing the meta results from setupSpotlightParser\n    // So we loop until our offset is greater than the meta.blocks value \n    while (offset < meta.blocks.length) {\n        // Parse 10 blocks\n        const results = getSpotlight(meta, store, offset);\n        if (results instanceof MacosError) {\n            console.error(results);\n            break;\n        }\n\n        offset += 10;\n\n        console.log(`Got ${results.length} entries!`);\n        for (const entry of results) {\n            console.log(`Inode: ${entry.inode}`);\n            const downloads = JSON.stringify(entry.values);\n            if (downloads.includes("Downloads") || downloads.includes(".pkg")) {\n                console.log(downloads);\n            }\n        }\n\n    }\n\n}\n\nmain();\n'})}),"\n",(0,a.jsx)(t.p,{children:"Example output you may see:"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-json",children:'Inode: 21365561\n{\n    "_kMDItemContentModificationDateWeekday": {\n        "attribute": "AttrVariableSizeIntMultiValue",\n        "value": [\n            3\n        ]\n    },\n    "_kMDItemContentCreationDateWeekOfMonth": {\n        "attribute": "AttrVariableSizeIntMultiValue",\n        "value": [\n            4\n        ]\n    },\n    "_kMDItemContentModificationDateWeekOfYear": {\n        "attribute": "AttrVariableSizeIntMultiValue",\n        "value": [\n            21\n        ]\n    },\n    "_kMDItemContentModificationDateHour": {\n        "attribute": "AttrVariableSizeIntMultiValue",\n        "value": [\n            20\n        ]\n    },\n    "kMDItemDateAdded": {\n        "attribute": "AttrDate",\n        "value": [\n            "2025-05-21T00:46:33.000Z"\n        ]\n    },\n    "_kMDItemContentModificationDateWeekOfMonth": {\n        "attribute": "AttrVariableSizeIntMultiValue",\n        "value": [\n            4\n        ]\n    },\n    "_kMDItemContentCreationDateDay": {\n        "attribute": "AttrVariableSizeIntMultiValue",\n        "value": [\n            20\n        ]\n    },\n    "_kMDItemContentCreationDateMonth": {\n        "attribute": "AttrVariableSizeIntMultiValue",\n        "value": [\n            5\n        ]\n    },\n    "kMDItemContentCreationDate": {\n        "attribute": "AttrDate",\n        "value": [\n            "2025-05-21T00:45:35.000Z"\n        ]\n    },\n    "_kMDItemContentCreationDateWeekdayOrdinal": {\n        "attribute": "AttrVariableSizeIntMultiValue",\n        "value": [\n            3\n        ]\n    },\n    "_kMDItemContentModificationDateYear": {\n        "attribute": "AttrVariableSizeIntMultiValue",\n        "value": [\n            2025\n        ]\n    },\n    "kMDItemDocumentIdentifier": {\n        "attribute": "AttrVariableSizeIntMultiValue",\n        "value": [\n            0\n        ]\n    },\n    "_kMDItemContentModificationDateWeekdayOrdinal": {\n        "attribute": "AttrVariableSizeIntMultiValue",\n        "value": [\n            3\n        ]\n    },\n    "kMDItemInterestingDate_Ranking": {\n        "attribute": "AttrDate",\n        "value": [\n            "2025-05-21T00:00:00.000Z"\n        ]\n    },\n    "_kMDItemCreationDate": {\n        "attribute": "AttrDate",\n        "value": [\n            "2025-05-21T00:45:35.000Z"\n        ]\n    },\n    "_kMDItemFromImporter": {\n        "attribute": "AttrBool",\n        "value": true\n    },\n    "kMDItemKind": {\n        "attribute": "AttrList",\n        "value": [\n            "INSTALLER_FLAT_PACKAGE\\u0016\\u0002",\n            "INSTALLER_FLAT_PACKAGE\\u0016\\u0002Base",\n            "\u062d\u0632\u0645\u0629 \u0627\u0644\u0645\u062b\u0628\u0651\u062a \u0627\u0644\u0645\u0633\u0637\u062d\u0629\\u0016\\u0002ar",\n            "Paquet simple de l\u2019instal\xb7lador\\u0016\\u0002ca",\n            "Bali\u0301c\u030cek instala\u0301toru (flat)\\u0016\\u0002cs",\n            "Flad installeringspakke\\u0016\\u0002da",\n            "Einfaches Installationspaket\\u0016\\u0002de",\n            "\u0395\u03c0\u03b9\u0301\u03c0\u03b5\u03b4\u03bf \u03c0\u03b1\u03ba\u03b5\u0301\u03c4\u03bf \u03c4\u03bf\u03c5 \u03c0\u03c1\u03bf\u03b3\u03c1\u03b1\u0301\u03bc\u03bc\u03b1\u03c4\u03bf\u03c2 \u03b5\u03b3\u03ba\u03b1\u03c4\u03b1\u0301\u03c3\u03c4\u03b1\u03c3\u03b7\u03c2\\u0016\\u0002el",\n            "Installer flat package\\u0016\\u0002en",\n            "Installer flat package\\u0016\\u0002en_AU",\n            "Installer flat package\\u0016\\u0002en_GB",\n            "Paquete plano del instalador\\u0016\\u0002es",\n            "Paquete raso del Instalador\\u0016\\u0002es_419",\n            "Asentajan littea\u0308 paketti\\u0016\\u0002fi",\n            "Paquet brut du programme d\u2019installation\\u0016\\u0002fr",\n            "Paquet brut du programme d\u2019installation\\u0016\\u0002fr_CA",\n            "\u05d7\u05d1\u05d9\u05dc\u05ea \u05d4\u05ea\u05e7\u05e0\u05d4 \u05e9\u05d8\u05d5\u05d7\u05d4\\u0016\\u0002he",\n            "\u0907\u0902\u0938\u094d\u091f\u0949\u0932\u0930 \u092b\u093c\u094d\u0932\u0948\u091f \u092a\u0948\u0915\u0947\u091c\\u0016\\u0002hi",\n            "Obic\u030cni paket instalacijskog programa\\u0016\\u0002hr",\n            "Telepi\u0301to\u030b lapos csomag\\u0016\\u0002hu",\n            "Paket datar Penginstal\\u0016\\u0002id",\n            "Pacchetto flat Installer\\u0016\\u0002it",\n            "\u30a4\u30f3\u30b9\u30c8\u30fc\u30e9\u30fb\u30d5\u30e9\u30c3\u30c8\u30fb\u30cf\u309a\u30c3\u30b1\u30fc\u30b7\u3099\\u0016\\u0002ja",\n            "\u1109\u1165\u11af\u110e\u1175 \u1111\u1173\u1105\u1169\u1100\u1173\u1105\u1162\u11b7 \u1111\u1173\u11af\u1105\u1162\u11ba \u1111\u1162\u110f\u1175\u110c\u1175\\u0016\\u0002ko",\n            "Pakej rata pemasang\\u0016\\u0002ms",\n            "Installatieprogramma-pakket (plat)\\u0016\\u0002nl",\n            "Installerer for flat pakke\\u0016\\u0002no",\n            "jednorodny pakiet instalacyjny\\u0016\\u0002pl",\n            "Pacote simples do Instalador\\u0016\\u0002pt",\n            "Pacote simples do Instalador\\u0016\\u0002pt_PT",\n            "Pachet plat Program de instalare\\u0016\\u0002ro",\n            "\u041f\u0440\u043e\u0441\u0442\u043e\u0438\u0306 \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043e\u0447\u043d\u044b\u0438\u0306 \u043f\u0430\u043a\u0435\u0442\\u0016\\u0002ru",\n            "Paus\u030ca\u0301lny ins\u030ctalac\u030cny\u0301 bali\u0301k\\u0016\\u0002sk",\n            "Enostaven paket namestitvenega programa\\u0016\\u0002sl",\n            "Platt installationspaket\\u0016\\u0002sv",\n            "\u0e0a\u0e38\u0e14\u0e42\u0e1b\u0e23\u0e41\u0e01\u0e23\u0e21\u0e15\u0e31\u0e27\u0e15\u0e34\u0e14\u0e15\u0e31\u0e49\u0e07\u0e41\u0e1a\u0e1a Flat\\u0016\\u0002th",\n            "Du\u0308z yap\u0131l\u0131 Yu\u0308kleyici paketi\\u0016\\u0002tr",\n            "\u0417\u0432\u0438\u0447\u0430\u0438\u0306\u043d\u0438\u0438\u0306 \u043f\u0430\u043a\u0435\u0442 \u0406\u043d\u0441\u0442\u0430\u043b\u044f\u0442\u043e\u0440\u0430\\u0016\\u0002uk",\n            "Go\u0301i tri\u0300nh ca\u0300i \u0111a\u0323\u0306t pha\u0306\u0309ng\\u0016\\u0002vi",\n            "\u5b89\u88c5\u5668flat\u8f6f\u4ef6\u5305\\u0016\\u0002zh_CN",\n            "\u5b89\u88dd\u7a0b\u5f0f\u55ae\u5c64\u5957\u4ef6\\u0016\\u0002zh_HK",\n            "\u5b89\u88dd\u7a0b\u5f0f\u55ae\u5c64\u5957\u4ef6\\u0016\\u0002zh_TW"\n        ]\n    },\n    "_kMDItemGroupId": {\n        "attribute": "AttrVariableSizeInt",\n        "value": 18\n    },\n    "_kMDItemContentCreationDateHour": {\n        "attribute": "AttrVariableSizeIntMultiValue",\n        "value": [\n            20\n        ]\n    },\n    "_kMDItemOwnerGroupID": {\n        "attribute": "AttrVariableSizeIntMultiValue",\n        "value": [\n            20\n        ]\n    },\n    "_kMDItemTypeCode": {\n        "attribute": "AttrVariableSizeIntMultiValue",\n        "value": [\n            0\n        ]\n    },\n    "_kMDItemContentCreationDateYear": {\n        "attribute": "AttrVariableSizeIntMultiValue",\n        "value": [\n            2025\n        ]\n    },\n    "kMDItemPhysicalSize": {\n        "attribute": "AttrVariableSizeIntMultiValue",\n        "value": [\n            25919488\n        ]\n    },\n    "_kMDItemPrescanCandidate": {\n        "attribute": "AttrBool",\n        "value": true\n    },\n    "_kMDItemIsExtensionHidden": {\n        "attribute": "AttrBool",\n        "value": false\n    },\n    "kMDItemDisplayName": {\n        "attribute": "AttrString",\n        "value": "osquery-5.17.0.pkg\\u0016\\u0002"\n    },\n    "kMDItemContentModificationDate": {\n        "attribute": "AttrDate",\n        "value": [\n            "2025-05-21T00:45:48.000Z"\n        ]\n    },\n    "_kMDItemDisplayNameWithExtensions": {\n        "attribute": "AttrString",\n        "value": "osquery-5.17.0.pkg\\u0016\\u0002"\n    },\n    "_kMDItemCreatorCode": {\n        "attribute": "AttrVariableSizeIntMultiValue",\n        "value": [\n            0\n        ]\n    },\n    "kMDItemContentTypeTree": {\n        "attribute": "AttrList",\n        "value": [\n            "com.apple.installer-package-archive",\n            "public.data",\n            "public.item",\n            "public.archive"\n        ]\n    },\n    "_kMDItemContentChangeDate": {\n        "attribute": "AttrDate",\n        "value": [\n            "2025-05-21T00:45:48.000Z"\n        ]\n    },\n    "kMDItemContentCreationDate_Ranking": {\n        "attribute": "AttrDate",\n        "value": [\n            "2025-05-21T00:00:00.000Z"\n        ]\n    },\n    "_kMDItemInterestingDate": {\n        "attribute": "AttrDate",\n        "value": [\n            "2025-05-21T00:45:48.000Z"\n        ]\n    },\n    "_kMDItemContentModificationDateDay": {\n        "attribute": "AttrVariableSizeIntMultiValue",\n        "value": [\n            20\n        ]\n    },\n    "_kMDItemContentCreationDateWeekOfYear": {\n        "attribute": "AttrVariableSizeIntMultiValue",\n        "value": [\n            21\n        ]\n    },\n    "_kMDItemFinderFlags": {\n        "attribute": "AttrVariableSizeIntMultiValue",\n        "value": [\n            0\n        ]\n    },\n    "kMDItemLogicalSize": {\n        "attribute": "AttrVariableSizeIntMultiValue",\n        "value": [\n            25005632\n        ]\n    },\n    "_kMDItemOwnerUserID": {\n        "attribute": "AttrVariableSizeIntMultiValue",\n        "value": [\n            501\n        ]\n    },\n    "_kMDItemFileName": {\n        "attribute": "AttrString",\n        "value": "osquery-5.17.0.pkg"\n    },\n    "_kMDItemTextContentIndexExists": {\n        "attribute": "AttrBool",\n        "value": false\n    },\n    "kMDItemContentType": {\n        "attribute": "AttrList",\n        "value": "com.apple.installer-package-archive"\n    },\n    "_kMDItemContentCreationDateWeekday": {\n        "attribute": "AttrVariableSizeIntMultiValue",\n        "value": [\n            3\n        ]\n    },\n    "_kMDItemFinderLabel": {\n        "attribute": "AttrVariableSizeIntMultiValue",\n        "value": [\n            0\n        ]\n    },\n    "_kMDItemContentModificationDateMonth": {\n        "attribute": "AttrVariableSizeIntMultiValue",\n        "value": [\n            5\n        ]\n    }\n}\n'})}),"\n",(0,a.jsx)(t.h3,{id:"getxprotectdefinitionsalt_path---xprotectentries--macoserror",children:"getXprotectDefinitions(alt_path) -> XprotectEntries[] | MacosError"}),"\n",(0,a.jsx)(t.p,{children:"Grab Xprotect definitions on macOS. By default artemis will check for\nXprotect.plist files at:"}),"\n",(0,a.jsxs)(t.ul,{children:["\n",(0,a.jsx)(t.li,{children:"/Library/Apple/System/Library/CoreServices/XProtect.bundle/Contents/Resources/Xprotect.plist"}),"\n",(0,a.jsx)(t.li,{children:"/System/Library/CoreServices/CoreTypes.bundle/Contents/Resources/Xprotect.plist"}),"\n"]}),"\n",(0,a.jsx)(t.p,{children:"You may also provide an optional alternative path to the Xprotect.plist file."}),"\n",(0,a.jsxs)(t.table,{children:[(0,a.jsx)(t.thead,{children:(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.th,{children:"Param"}),(0,a.jsx)(t.th,{children:"Type"}),(0,a.jsx)(t.th,{children:"Description"})]})}),(0,a.jsx)(t.tbody,{children:(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"alt_path"}),(0,a.jsx)(t.td,{children:"string"}),(0,a.jsx)(t.td,{children:"Optional path to Xprotect.plist file"})]})})]}),"\n",(0,a.jsx)(t.h3,{id:"lulurulesalt_path---lulurules--macoserror",children:"luluRules(alt_path) -> LuluRules | MacosError"}),"\n",(0,a.jsx)(t.p,{children:"Grab LuLu rules on macOS. By default artemis will check for rule.plist file at:"}),"\n",(0,a.jsxs)(t.ul,{children:["\n",(0,a.jsx)(t.li,{children:"/Library/Objective-See/LuLu/rules.plist"}),"\n"]}),"\n",(0,a.jsx)(t.p,{children:"You may also provide an optional alternative path to the rules.plist file."}),"\n",(0,a.jsxs)(t.table,{children:[(0,a.jsx)(t.thead,{children:(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.th,{children:"Param"}),(0,a.jsx)(t.th,{children:"Type"}),(0,a.jsx)(t.th,{children:"Description"})]})}),(0,a.jsx)(t.tbody,{children:(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"alt_file"}),(0,a.jsx)(t.td,{children:"string"}),(0,a.jsx)(t.td,{children:"Optional path to rules.plist file"})]})})]}),"\n",(0,a.jsx)(t.h3,{id:"munkiapplicationusagedb---munkiapplicationusage--macoserror",children:"munkiApplicationUsage(db) -> MunkiApplicationUsage[] | MacosError"}),"\n",(0,a.jsx)(t.p,{children:"Grab application usage tracked by Munki on macOS. By default artemis will check\nfor application_usage.sqlite file at:"}),"\n",(0,a.jsxs)(t.ul,{children:["\n",(0,a.jsx)(t.li,{children:"/Library/Managed Installs/application_usage.sqlite"}),"\n"]}),"\n",(0,a.jsx)(t.p,{children:"You may also provide an optional alternative path to the\napplication_usage.sqlite file."}),"\n",(0,a.jsxs)(t.table,{children:[(0,a.jsx)(t.thead,{children:(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.th,{children:"Param"}),(0,a.jsx)(t.th,{children:"Type"}),(0,a.jsx)(t.th,{children:"Description"})]})}),(0,a.jsx)(t.tbody,{children:(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"db"}),(0,a.jsx)(t.td,{children:"string"}),(0,a.jsx)(t.td,{children:"Optional path to application_usage.sqlite file"})]})})]}),"\n",(0,a.jsx)(t.h3,{id:"quarantineeventsalt_file---macosquarantine--macoserror",children:"quarantineEvents(alt_file) -> MacosQuarantine[] | MacosError"}),"\n",(0,a.jsx)(t.p,{children:"Grab quarantine events tracked by macOS. By default artemis will check for\nquarantine events for all users file at:"}),"\n",(0,a.jsxs)(t.ul,{children:["\n",(0,a.jsx)(t.li,{children:"/Users/*/Library/Preferences/com.apple.LaunchServices.QuarantineEventsV2"}),"\n"]}),"\n",(0,a.jsx)(t.p,{children:"You may also provide an optional alternative path to the\ncom.apple.LaunchServices.QuarantineEventsV2 file."}),"\n",(0,a.jsxs)(t.table,{children:[(0,a.jsx)(t.thead,{children:(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.th,{children:"Param"}),(0,a.jsx)(t.th,{children:"Type"}),(0,a.jsx)(t.th,{children:"Description"})]})}),(0,a.jsx)(t.tbody,{children:(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"alt_file"}),(0,a.jsx)(t.td,{children:"string"}),(0,a.jsx)(t.td,{children:"Optional path to com.apple.LaunchServices.QuarantineEventsV2 file"})]})})]}),"\n",(0,a.jsx)(t.h3,{id:"parsebiomeapp_focus_only-alt_file---biome",children:"parseBiome(app_focus_only, alt_file) -> Biome[]"}),"\n",(0,a.jsx)(t.p,{children:"Parse a Biome files and try to extract data. By default artemis will only parse\nApp.InFocus files located at:"}),"\n",(0,a.jsxs)(t.ul,{children:["\n",(0,a.jsx)(t.li,{children:"/Users/*/Library/Biome/streams/*/*/local/*"}),"\n",(0,a.jsx)(t.li,{children:"/Users/*/Library/Biome/streams/*/*/local/tombstone/*"}),"\n",(0,a.jsx)(t.li,{children:"/private/var/db/biome/streams/*/*/local/*"}),"\n",(0,a.jsx)(t.li,{children:"/private/var/db/biome/streams/*/*/local/tombstone/*"}),"\n"]}),"\n",(0,a.jsxs)(t.table,{children:[(0,a.jsx)(t.thead,{children:(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.th,{children:"Param"}),(0,a.jsx)(t.th,{children:"Type"}),(0,a.jsx)(t.th,{children:"Description"})]})}),(0,a.jsxs)(t.tbody,{children:[(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"app_focus_only"}),(0,a.jsx)(t.td,{children:"boolean"}),(0,a.jsxs)(t.td,{children:["Only parse App.InFocus files. Default is ",(0,a.jsx)(t.strong,{children:"true"})]})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"alt_file"}),(0,a.jsx)(t.td,{children:"string"}),(0,a.jsx)(t.td,{children:"Optional path to an alternative Biome file"})]})]})]}),"\n",(0,a.jsx)(t.h3,{id:"gatekeeperentriesdb---gatekeeperentries--macoserror",children:"gatekeeperEntries(db) -> GatekeeperEntries[] | MacosError"}),"\n",(0,a.jsx)(t.p,{children:"Grab Gatekeeper entries on macOS. By default artemis will parse the sqlite\ndatabase at:"}),"\n",(0,a.jsxs)(t.ul,{children:["\n",(0,a.jsx)(t.li,{children:"/var/db/SystemPolicy"}),"\n"]}),"\n",(0,a.jsx)(t.p,{children:"You may also provide an optional alternative path to the SystemPolicy file."}),"\n",(0,a.jsxs)(t.table,{children:[(0,a.jsx)(t.thead,{children:(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.th,{children:"Param"}),(0,a.jsx)(t.th,{children:"Type"}),(0,a.jsx)(t.th,{children:"Description"})]})}),(0,a.jsx)(t.tbody,{children:(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"db"}),(0,a.jsx)(t.td,{children:"string"}),(0,a.jsx)(t.td,{children:"Optional path to SystemPolicy file"})]})})]}),"\n",(0,a.jsx)(t.h3,{id:"logonsmacospath-archive_path---logonmacos--macoserror",children:"logonsMacos(path, archive_path) -> LogonMacos[] | MacosError"}),"\n",(0,a.jsx)(t.p,{children:"Extract Logon entries from UnifiedLog files (.tracev3) on macOS. Typically found\nat:"}),"\n",(0,a.jsxs)(t.ul,{children:["\n",(0,a.jsx)(t.li,{children:"/private/var/db/diagnostics/Special"}),"\n"]}),"\n",(0,a.jsx)(t.p,{children:"You may also specify an optional logarchive style directory containing the\nUnified Log metadata (UUID directories, timesync, and dsc directory). Otherwise\nartemis will parse their default locations."}),"\n",(0,a.jsxs)(t.table,{children:[(0,a.jsx)(t.thead,{children:(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.th,{children:"Param"}),(0,a.jsx)(t.th,{children:"Type"}),(0,a.jsx)(t.th,{children:"Description"})]})}),(0,a.jsxs)(t.tbody,{children:[(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"path"}),(0,a.jsx)(t.td,{children:"string"}),(0,a.jsx)(t.td,{children:"Path to .tracev3 file"})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"archive_path"}),(0,a.jsx)(t.td,{children:"string"}),(0,a.jsx)(t.td,{children:"Optional path to a logarchive style directory containing Unified Log metadata"})]})]})]}),"\n",(0,a.jsx)(t.h3,{id:"parsecookiespath---cookie--macoserror",children:"parseCookies(path) -> Cookie[] | MacosError"}),"\n",(0,a.jsx)(t.p,{children:"Parse binary Safri cookie at provided path."}),"\n",(0,a.jsxs)(t.table,{children:[(0,a.jsx)(t.thead,{children:(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.th,{children:"Param"}),(0,a.jsx)(t.th,{children:"Type"}),(0,a.jsx)(t.th,{children:"Description"})]})}),(0,a.jsx)(t.tbody,{children:(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"path"}),(0,a.jsx)(t.td,{children:"string"}),(0,a.jsx)(t.td,{children:"Path to binary cookie file"})]})})]}),"\n",(0,a.jsx)(t.h3,{id:"safari-browser-class",children:"Safari Browser Class"}),"\n",(0,a.jsx)(t.p,{children:"A basic TypeScript class to extract data from the Safari browser. You may optionally enable Unfold URL parsing (default is disabled) and provide an alternative glob to the base Safari directory."}),"\n",(0,a.jsx)(t.p,{children:"Sample TypeScript code:"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-typescript",children:'import { Safari, PlatformType } from "./artemis-api/mod";\n\nfunction main() {\n  const enable_unfold = true;\n  const client = new Safari(PlatformType.Darwin, enable_unfold);\n\n  const start = 0;\n  const limit = 300;\n  const history_data = client.history(start, limit);\n  console.log(JSON.stringify(history_data));\n}\n\nmain();\n'})}),"\n",(0,a.jsx)(t.h4,{id:"historyoffset-limit---safarihistory",children:"history(offset, limit) -> SafariHistory[]"}),"\n",(0,a.jsxs)(t.p,{children:["Return Safari history for all users. Safari history exists in a sqlite database.",(0,a.jsx)(t.br,{}),"\n","Artemis will bypass locked sqlite databases when querying history.",(0,a.jsx)(t.br,{}),"\n","You may provide a starting offset and limit when querying history.",(0,a.jsx)(t.br,{}),"\n","By default artemis will get the first 100 entries for all users."]}),"\n",(0,a.jsxs)(t.table,{children:[(0,a.jsx)(t.thead,{children:(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.th,{children:"Param"}),(0,a.jsx)(t.th,{children:"Type"}),(0,a.jsx)(t.th,{children:"Description"})]})}),(0,a.jsxs)(t.tbody,{children:[(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"offset"}),(0,a.jsx)(t.td,{children:"number"}),(0,a.jsx)(t.td,{children:"Starting offset when querying the sqlite database"})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"limit"}),(0,a.jsx)(t.td,{children:"number"}),(0,a.jsx)(t.td,{children:"Max number of rows to return per user"})]})]})]}),"\n",(0,a.jsx)(t.h4,{id:"downloads---safaridownloads",children:"downloads() -> SafariDownloads[]"}),"\n",(0,a.jsx)(t.p,{children:"Return Safari file downloads for all users. Safari file downloads exists in a plist file."}),"\n",(0,a.jsx)(t.h4,{id:"faviconsoffset-limit---safarifavicons",children:"favicons(offset, limit) -> SafariFavicons[]"}),"\n",(0,a.jsxs)(t.p,{children:["Return Safari favicons for all users. Safari favicons exists in a sqlite database.",(0,a.jsx)(t.br,{}),"\n","Artemis will bypass locked sqlite databases when querying histfaviconsory.",(0,a.jsx)(t.br,{}),"\n","You may provide a starting offset and limit when querying favicons.",(0,a.jsx)(t.br,{}),"\n","By default artemis will get the first 100 entries for all users."]}),"\n",(0,a.jsxs)(t.table,{children:[(0,a.jsx)(t.thead,{children:(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.th,{children:"Param"}),(0,a.jsx)(t.th,{children:"Type"}),(0,a.jsx)(t.th,{children:"Description"})]})}),(0,a.jsxs)(t.tbody,{children:[(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"offset"}),(0,a.jsx)(t.td,{children:"number"}),(0,a.jsx)(t.td,{children:"Starting offset when querying the sqlite database"})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"limit"}),(0,a.jsx)(t.td,{children:"number"}),(0,a.jsx)(t.td,{children:"Max number of rows to return per user"})]})]})]}),"\n",(0,a.jsx)(t.h4,{id:"bookmarks---safaribookmark",children:"bookmarks() -> SafariBookmark[]"}),"\n",(0,a.jsx)(t.p,{children:"Return Safari bookmarks for all users."}),"\n",(0,a.jsx)(t.h4,{id:"cookies---cookie",children:"cookies() -> Cookie[]"}),"\n",(0,a.jsx)(t.p,{children:"Return Safari cookies for all users."}),"\n",(0,a.jsx)(t.h4,{id:"extensions---safariextensions",children:"extensions() -> SafariExtensions[]"}),"\n",(0,a.jsx)(t.p,{children:"Return Safari extensions for all users."}),"\n",(0,a.jsx)(t.h4,{id:"retrospectoutput---void",children:"retrospect(output) -> void"}),"\n",(0,a.jsxs)(t.p,{children:["A powerful feature that will timeline all Safari browser artifacts. This functionality is similar to ",(0,a.jsx)(t.a,{href:"https://github.com/obsidianforensics/hindsight",children:"Hindsight"}),"."]}),"\n",(0,a.jsxs)(t.p,{children:["You will need to provide an Output object specifying how you want to output the results. You may only output as JSON or JSONL. ",(0,a.jsx)(t.strong,{children:"JSONL"})," is strongly recommended. This function returns no data, instead it outputs the results based on your Output object."]}),"\n",(0,a.jsx)(t.p,{children:"Sample code below:"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-typescript",children:'import { Safari, PlatformType } from "./artemis-api/mod";\nimport { Output } from "./artemis-api/src/system/output";\n\nfunction main() {\n    const client = new Safari(PlatformType.Darwin);\n    const out: Output = {\n        name: "safari_timeline",\n        directory: "./tmp",\n        format: Format.JSONL,\n        compress: false,\n        // We can set this to false because the TypeScript/JavaScript API will timeline for us instead of using the Rust code\n        timeline: false,\n        endpoint_id: "abc",\n        collection_id: 0,\n        output: OutputType.LOCAL,\n    }\n\n    // No data is returned. Our results and errors will appear at `./tmp/safari_timeline`\n    client.retrospect(out);\n\n}\n\nmain();\n'})}),"\n",(0,a.jsx)(t.h3,{id:"parsesystemstatsalt_file---systemstats--macoserror",children:"parseSystemStats(alt_file) -> SystemStats[] | MacosError"}),"\n",(0,a.jsx)(t.p,{children:"Parse a stats files and try to extract data."}),"\n",(0,a.jsxs)(t.table,{children:[(0,a.jsx)(t.thead,{children:(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.th,{children:"Param"}),(0,a.jsx)(t.th,{children:"Type"}),(0,a.jsx)(t.th,{children:"Description"})]})}),(0,a.jsx)(t.tbody,{children:(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:"alt_file"}),(0,a.jsx)(t.td,{children:"string"}),(0,a.jsx)(t.td,{children:"Optional path to an alternative stats file"})]})})]})]})}function h(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,a.jsx)(t,{...e,children:(0,a.jsx)(c,{...e})}):c(e)}}}]);