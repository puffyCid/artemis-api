"use strict";(self.webpackChunkartemis_docs=self.webpackChunkartemis_docs||[]).push([[3882],{38002:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>r,default:()=>h,frontMatter:()=>a,metadata:()=>o,toc:()=>d});var i=n(74848),s=n(28453);const a={description:"Contains shims used by applications",keywords:["windows","binary","persistence"]},r="ShimDB",o={id:"Artifacts/Windows Artfacts/shimdb",title:"ShimDB",description:"Contains shims used by applications",source:"@site/docs/Artifacts/Windows Artfacts/shimdb.md",sourceDirName:"Artifacts/Windows Artfacts",slug:"/Artifacts/Windows Artfacts/shimdb",permalink:"/artemis-api/docs/Artifacts/Windows Artfacts/shimdb",draft:!1,unlisted:!1,editUrl:"https://github.com/puffyCid/artemis-api/tree/main/artemis-docs/docs/Artifacts/Windows Artfacts/shimdb.md",tags:[],version:"current",lastUpdatedBy:"puffyCid",lastUpdatedAt:173094914e4,frontMatter:{description:"Contains shims used by applications",keywords:["windows","binary","persistence"]},sidebar:"artemisArtifacts",previous:{title:"Shimcache",permalink:"/artemis-api/docs/Artifacts/Windows Artfacts/shimcache"},next:{title:"Shortcuts",permalink:"/artemis-api/docs/Artifacts/Windows Artfacts/shortcuts"}},c={},d=[];function l(e){const t={a:"a",code:"code",h1:"h1",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.header,{children:(0,i.jsx)(t.h1,{id:"shimdb",children:"ShimDB"})}),"\n",(0,i.jsxs)(t.p,{children:["Windows Shimdatabase (",(0,i.jsx)(t.code,{children:"ShimDB"}),") can be used by Windows applications to provided\ncompatability between Windows versions."]}),"\n",(0,i.jsx)(t.p,{children:"It does this via shims that are inserted into the application that modifies\nfunction calls. Malicious custom shims can be created as a form of persistence."}),"\n",(0,i.jsx)(t.p,{children:"OtherParsers:"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:(0,i.jsx)(t.a,{href:"https://ericzimmerman.github.io/",children:"SDBExplorer"})}),"\n"]}),"\n",(0,i.jsx)(t.p,{children:"References:"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:(0,i.jsx)(t.a,{href:"https://www.geoffchappell.com/studies/windows/win32/apphelp/sdb/index.htm",children:"ShimDB"})}),"\n",(0,i.jsx)(t.li,{children:(0,i.jsx)(t.a,{href:"https://www.mandiant.com/resources/blog/fin7-shim-databases-persistence",children:"ShimDB Persistence"})}),"\n"]}),"\n",(0,i.jsx)(t.h1,{id:"toml-collection",children:"TOML Collection"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-toml",children:'system = "windows"\n\n[output]\nname = "sdb_collection"\ndirectory = "./tmp"\nformat = "json"\ncompress = false\nendpoint_id = "6c51b123-1522-4572-9f2a-0bd5abd81b82"\ncollection_id = 1\noutput = "local"\n\n[[artifacts]]\nartifact_name = "shimdb"\n[artifacts.shimdb]\n# Optional\n# alt_file = "C:\\\\Artifacts\\\\bad.sdb"\n'})}),"\n",(0,i.jsx)(t.h1,{id:"collection-options",children:"Collection Options"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.code,{children:"alt_file"})," Full path to alternative ShimDB file. This configuration is\n",(0,i.jsx)(t.strong,{children:"optional"}),". By default artemis will ShimDB files at their default locations."]}),"\n"]}),"\n",(0,i.jsx)(t.h1,{id:"output-structure",children:"Output Structure"}),"\n",(0,i.jsxs)(t.p,{children:["An array of ",(0,i.jsx)(t.code,{children:"ShimDB"})," entries"]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-typescript",children:'export interface Shimdb {\n  /**Array of `TAGS` associated with the index tag*/\n  indexes: TagData[];\n  /**Data associated with the Shimdb */\n  db_data: DatabaseData;\n  /**Path to parsed sdb file */\n  sdb_path: string;\n}\n\n/**\n * SDB files are composed of `TAGS`. There are multiple types of `TAGS`\n * `data` have `TAGS` that can be represented via a JSON object\n * `list_data` have `TAGS` that can be represented as an array of JSON objects\n *\n * Example:\n * ```\n * "data": {\n *    "TAG_FIX_ID": "4aeea7ee-44f1-4085-abc2-6070eb2b6618",\n *    "TAG_RUNTIME_PLATFORM": "37",\n *    "TAG_NAME": "256Color"\n * },\n * "list_data": [\n *   {\n *      "TAG_NAME": "Force8BitColor",\n *      "TAG_SHIM_TAGID": "169608"\n *    },\n *    {\n *      "TAG_SHIM_TAGID": "163700",\n *      "TAG_NAME": "DisableThemes"\n *    }\n * ]\n * ```\n *\n * See https://www.geoffchappell.com/studies/windows/win32/apphelp/sdb/index.htm for complete list of `TAGS`\n */\nexport interface TagData {\n  /**TAGs represented as a JSON object */\n  data: Record<string, string>;\n  /**Array of TAGS represented as a JSON objects */\n  list_data: Record<string, string>[];\n}\n\n/**\n * Metadata related to the SDB file\n */\nexport interface DatabaseData {\n  /**SDB version info */\n  sdb_version: string;\n  /**Compile timestamp of the SDB file */\n  compile_time: string;\n  /**Compiler version info */\n  compiler_version: string;\n  /**Name of SDB */\n  name: string;\n  /**Platform ID */\n  platform: number;\n  /**ID associated with SDB */\n  database_id: string;\n  /**\n   * The SDB file may contain additional metadata information\n   * May include additional `TAGS`\n   */\n  additional_metadata: Record<string, string>;\n  /**Array of `TAGS` associated with the SDB file */\n  list_data: TagData[];\n}\n'})})]})}function h(e={}){const{wrapper:t}={...(0,s.R)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(l,{...e})}):l(e)}},28453:(e,t,n)=>{n.d(t,{R:()=>r,x:()=>o});var i=n(96540);const s={},a=i.createContext(s);function r(e){const t=i.useContext(a);return i.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),i.createElement(a.Provider,{value:t},e.children)}}}]);