"use strict";(globalThis.webpackChunkartemis_docs=globalThis.webpackChunkartemis_docs||[]).push([[9298],{9655:(n,e,r)=>{r.r(e),r.d(e,{assets:()=>l,contentTitle:()=>s,default:()=>u,frontMatter:()=>a,metadata:()=>o,toc:()=>c});const o=JSON.parse('{"id":"Intro/Daemon/enrollment","title":"Enrollment","description":"Daemon enrollment","source":"@site/docs/Intro/Daemon/enrollment.md","sourceDirName":"Intro/Daemon","slug":"/Intro/Daemon/enrollment","permalink":"/artemis-api/docs/Intro/Daemon/enrollment","draft":false,"unlisted":false,"editUrl":"https://github.com/puffyCid/artemis-api/tree/main/artemis-docs/docs/Intro/Daemon/enrollment.md","tags":[],"version":"current","lastUpdatedBy":"puffyCid","lastUpdatedAt":1767062193000,"sidebarPosition":3,"frontMatter":{"sidebar_position":3,"description":"Daemon enrollment"},"sidebar":"artemisStart","previous":{"title":"Getting Started","permalink":"/artemis-api/docs/Intro/Daemon/gettingstarted"},"next":{"title":"Configuration","permalink":"/artemis-api/docs/Intro/Daemon/configuration"}}');var t=r(74848),i=r(28453);const a={sidebar_position:3,description:"Daemon enrollment"},s="Enrollment",l={},c=[{value:"Enrollment Request",id:"enrollment-request",level:2},{value:"Enrollment Payload",id:"enrollment-payload",level:3},{value:"Enrollment Response",id:"enrollment-response",level:2}];function d(n){const e={br:"br",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...n.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(e.header,{children:(0,t.jsx)(e.h1,{id:"enrollment",children:"Enrollment"})}),"\n",(0,t.jsxs)(e.p,{children:["In order to connect to a supported server artemis must use an enrollment secret. Once a remote server accepts the enrollment request it should generate a node_key for the endpoint.",(0,t.jsx)(e.br,{}),"\n","When artemis receives the node_key, it will use the node_key instead of the enrollment secret for all future communications with the remote server."]}),"\n",(0,t.jsx)(e.h2,{id:"enrollment-request",children:"Enrollment Request"}),"\n",(0,t.jsxs)(e.p,{children:["The artemis daemon expects a ",(0,t.jsx)(e.strong,{children:"server.toml"})," file in order to start the enrollment process. You may provide an optional path to the TOML file, otherwise artemis will search for a TOML file in the current directory.",(0,t.jsx)(e.br,{}),"\n","The server.toml file should contain the following fields:"]}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:"url: Remote server URL"}),"\n",(0,t.jsx)(e.li,{children:"port: Port number to communicate with"}),"\n",(0,t.jsx)(e.li,{children:"ignore_ssl: Boolean value if artemis should ignore self signed SSL certs"}),"\n",(0,t.jsx)(e.li,{children:"enrollment: The remote URI artemis should use to enrollment the endpoint. There should be no forward slash at the beginning."}),"\n",(0,t.jsx)(e.li,{children:"config: The remote URI artemis should to request a daemon configuration for the endpoint. There should be no forward slash at the beginning."}),"\n",(0,t.jsx)(e.li,{children:"collections: The remote URI artemis should use to request collection jobs. There should be no forward slash at the beginning."}),"\n",(0,t.jsx)(e.li,{children:"version: Remote server version"}),"\n",(0,t.jsx)(e.li,{children:"key: The enrollment secret"}),"\n"]}),"\n",(0,t.jsxs)(e.p,{children:["All fields are ",(0,t.jsx)(e.strong,{children:"required"}),"."]}),"\n",(0,t.jsx)(e.p,{children:"An example server.toml file is below:"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-toml",children:'[server]\nurl = "http://127.0.0.1"\nport = 8000\nignore_ssl = false\nenrollment = "endpoint/enroll"\ncollections = "endpoint/collections"\nconfig = "endpoint/config"\nversion = 1\nkey = "my key"\n'})}),"\n",(0,t.jsx)(e.h3,{id:"enrollment-payload",children:"Enrollment Payload"}),"\n",(0,t.jsxs)(e.p,{children:["Once artemis reads the server.toml file, it will try to enroll to the remote server.  It will try 8 attempts to enroll to the server.\nThe remote server enrollment URI should be a combination of the enrollment URI and the remote server version.",(0,t.jsx)(e.br,{}),"\n","Example: ",(0,t.jsx)(e.strong,{children:"/v1/endpoint/enrollment"}),".  If the version field was 2 then the URI would be ",(0,t.jsx)(e.strong,{children:"/v2/endpoint/enrollment"})]}),"\n",(0,t.jsx)(e.p,{children:"After each failed enrollment attempt it will pause for 6 seconds and then try again."}),"\n",(0,t.jsx)(e.p,{children:"Each enrollment attempt it will send the following POST request to the enrollment URI"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-json",children:'{\n    "enroll_key": "pre-shared enrollment secret",\n    "endpoint_uuid": "UUID generated by the endpoint",\n    "info": "basic systeminfo about the endpoint",\n}\n'})}),"\n",(0,t.jsxs)(e.p,{children:["The info object is the ",(0,t.jsx)(e.strong,{children:"systeminfo"})," artifact for the endpoint. It will always contain the following info:"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-typescript",children:"/**\n * Systeminfo is a collection of metadata about the endpoint\n */\nexport interface SystemInfo {\n  /**Boot time for endpoint */\n  boot_time: string;\n  /**Endpoint hostname */\n  hostname: string;\n  /**Endpoint OS version */\n  os_version: string;\n  /**Uptime of endpoint */\n  uptime: number;\n  /**Endpoint kernel version */\n  kernel_version: string;\n  /**Endpoint platform */\n  platform: string;\n  /**CPU information */\n  cpu: Cpus[];\n  /**Disks information */\n  disks: Disks[];\n  /**Memory information */\n  memory: Memory;\n  /**Performance information */\n  performance: LoadPerformance;\n  /**Array of network interfaces on the endpoint */\n  interfaces: NetworkInterface[];\n  /**Artemis version number */\n  version: string;\n  /**Rust version used to compile artemis*/\n  rust_version: string;\n  /**Artemis binary build date */\n  build_date: string;\n}\n\n/**\n * CPU information on endpoint\n */\nexport interface Cpus {\n  /**CPU frequency */\n  frequency: number;\n  /**CPU usage on endpoint */\n  cpu_usage: number;\n  /**Name of CPU */\n  name: string;\n  /**Vendor ID for CPU */\n  vendor_id: string;\n  /**CPU brand */\n  brand: string;\n  /**Core Count */\n  physical_core_count: number;\n}\n\n/**\n * Disk information on endpoint\n */\nexport interface Disks {\n  /**Type of disk */\n  disk_type: string;\n  /**Filesystem for disk */\n  file_system: string;\n  /**Disk mount point */\n  mount_point: string;\n  /**Disk storage */\n  total_space: number;\n  /**Storage remaining */\n  available_space: number;\n  /**If disk is removable */\n  removable: boolean;\n}\n\n/**\n * Memory information on endpoint\n */\nexport interface Memory {\n  /**Available memory on endpoint */\n  available_memory: number;\n  /**Free memory on endpoint */\n  free_memory: number;\n  /**Free swap on endpoint */\n  free_swap: number;\n  /**Total memory on endpoint */\n  total_memory: number;\n  /**Total swap on endpoint */\n  total_swap: number;\n  /**Memory in use */\n  used_memory: number;\n  /**Swap in use */\n  used_swap: number;\n}\n\n/**\n * Average CPU load. These values are always zero (0) on Windows\n */\nexport interface LoadPerformance {\n  /**Average load for one (1) min */\n  avg_one_min: number;\n  /**Average load for five (5) min */\n  avg_five_min: number;\n  /**Average load for fifteen (15) min */\n  avg_fifteen_min: number;\n}\n\nexport interface NetworkInterface {\n  /**IP address for the endpoint */\n  ip: string;\n  /**MAC address for the network interface */\n  mac: string;\n  /**Name of the network interface */\n  name: string;\n}\n"})}),"\n",(0,t.jsx)(e.p,{children:"Example enrollment payload:"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-json",children:'{\n    "enroll_key": "my key",\n    "endpoint_uuid": "78db64c9-6cce-4e20-9da5-1525b449546a",\n    "info": {\n        "boot_time": "2025-05-23T00:33:39.000Z",\n        "hostname": "fedora",\n        "os_version": "41",\n        "uptime": 2168893,\n        "kernel_version": "6.8.11-300.fc40.x86_64",\n        "platform": "Fedora Linux",\n        "cpu": [\n            {\n                "frequency": 1100,\n                "cpu_usage": 0,\n                "name": "cpu0",\n                "vendor_id": "GenuineIntel",\n                "brand": "13th Gen Intel(R) Core(TM) i9-13900K",\n                "physical_core_count": 24\n            },\n            {\n                "frequency": 1100,\n                "cpu_usage": 0,\n                "name": "cpu1",\n                "vendor_id": "GenuineIntel",\n                "brand": "13th Gen Intel(R) Core(TM) i9-13900K",\n                "physical_core_count": 24\n            },\n            {\n                "frequency": 1099,\n                "cpu_usage": 0,\n                "name": "cpu2",\n                "vendor_id": "GenuineIntel",\n                "brand": "13th Gen Intel(R) Core(TM) i9-13900K",\n                "physical_core_count": 24\n            },\n            {\n                "frequency": 3082,\n                "cpu_usage": 0,\n                "name": "cpu3",\n                "vendor_id": "GenuineIntel",\n                "brand": "13th Gen Intel(R) Core(TM) i9-13900K",\n                "physical_core_count": 24\n            },\n            {\n                "frequency": 1100,\n                "cpu_usage": 0,\n                "name": "cpu4",\n                "vendor_id": "GenuineIntel",\n                "brand": "13th Gen Intel(R) Core(TM) i9-13900K",\n                "physical_core_count": 24\n            },\n            {\n                "frequency": 3044,\n                "cpu_usage": 0,\n                "name": "cpu5",\n                "vendor_id": "GenuineIntel",\n                "brand": "13th Gen Intel(R) Core(TM) i9-13900K",\n                "physical_core_count": 24\n            },\n            {\n                "frequency": 1042,\n                "cpu_usage": 0,\n                "name": "cpu6",\n                "vendor_id": "GenuineIntel",\n                "brand": "13th Gen Intel(R) Core(TM) i9-13900K",\n                "physical_core_count": 24\n            },\n            {\n                "frequency": 1041,\n                "cpu_usage": 0,\n                "name": "cpu7",\n                "vendor_id": "GenuineIntel",\n                "brand": "13th Gen Intel(R) Core(TM) i9-13900K",\n                "physical_core_count": 24\n            },\n            {\n                "frequency": 1100,\n                "cpu_usage": 0,\n                "name": "cpu8",\n                "vendor_id": "GenuineIntel",\n                "brand": "13th Gen Intel(R) Core(TM) i9-13900K",\n                "physical_core_count": 24\n            },\n            {\n                "frequency": 2701,\n                "cpu_usage": 0,\n                "name": "cpu9",\n                "vendor_id": "GenuineIntel",\n                "brand": "13th Gen Intel(R) Core(TM) i9-13900K",\n                "physical_core_count": 24\n            },\n            {\n                "frequency": 3087,\n                "cpu_usage": 0,\n                "name": "cpu10",\n                "vendor_id": "GenuineIntel",\n                "brand": "13th Gen Intel(R) Core(TM) i9-13900K",\n                "physical_core_count": 24\n            },\n            {\n                "frequency": 1196,\n                "cpu_usage": 0,\n                "name": "cpu11",\n                "vendor_id": "GenuineIntel",\n                "brand": "13th Gen Intel(R) Core(TM) i9-13900K",\n                "physical_core_count": 24\n            },\n            {\n                "frequency": 1057,\n                "cpu_usage": 0,\n                "name": "cpu12",\n                "vendor_id": "GenuineIntel",\n                "brand": "13th Gen Intel(R) Core(TM) i9-13900K",\n                "physical_core_count": 24\n            },\n            {\n                "frequency": 3087,\n                "cpu_usage": 0,\n                "name": "cpu13",\n                "vendor_id": "GenuineIntel",\n                "brand": "13th Gen Intel(R) Core(TM) i9-13900K",\n                "physical_core_count": 24\n            },\n            {\n                "frequency": 1100,\n                "cpu_usage": 0,\n                "name": "cpu14",\n                "vendor_id": "GenuineIntel",\n                "brand": "13th Gen Intel(R) Core(TM) i9-13900K",\n                "physical_core_count": 24\n            },\n            {\n                "frequency": 1039,\n                "cpu_usage": 0,\n                "name": "cpu15",\n                "vendor_id": "GenuineIntel",\n                "brand": "13th Gen Intel(R) Core(TM) i9-13900K",\n                "physical_core_count": 24\n            },\n            {\n                "frequency": 800,\n                "cpu_usage": 0,\n                "name": "cpu16",\n                "vendor_id": "GenuineIntel",\n                "brand": "13th Gen Intel(R) Core(TM) i9-13900K",\n                "physical_core_count": 24\n            },\n            {\n                "frequency": 800,\n                "cpu_usage": 0,\n                "name": "cpu17",\n                "vendor_id": "GenuineIntel",\n                "brand": "13th Gen Intel(R) Core(TM) i9-13900K",\n                "physical_core_count": 24\n            },\n            {\n                "frequency": 800,\n                "cpu_usage": 0,\n                "name": "cpu18",\n                "vendor_id": "GenuineIntel",\n                "brand": "13th Gen Intel(R) Core(TM) i9-13900K",\n                "physical_core_count": 24\n            },\n            {\n                "frequency": 2559,\n                "cpu_usage": 0,\n                "name": "cpu19",\n                "vendor_id": "GenuineIntel",\n                "brand": "13th Gen Intel(R) Core(TM) i9-13900K",\n                "physical_core_count": 24\n            },\n            {\n                "frequency": 800,\n                "cpu_usage": 0,\n                "name": "cpu20",\n                "vendor_id": "GenuineIntel",\n                "brand": "13th Gen Intel(R) Core(TM) i9-13900K",\n                "physical_core_count": 24\n            },\n            {\n                "frequency": 800,\n                "cpu_usage": 0,\n                "name": "cpu21",\n                "vendor_id": "GenuineIntel",\n                "brand": "13th Gen Intel(R) Core(TM) i9-13900K",\n                "physical_core_count": 24\n            },\n            {\n                "frequency": 1953,\n                "cpu_usage": 0,\n                "name": "cpu22",\n                "vendor_id": "GenuineIntel",\n                "brand": "13th Gen Intel(R) Core(TM) i9-13900K",\n                "physical_core_count": 24\n            },\n            {\n                "frequency": 1239,\n                "cpu_usage": 0,\n                "name": "cpu23",\n                "vendor_id": "GenuineIntel",\n                "brand": "13th Gen Intel(R) Core(TM) i9-13900K",\n                "physical_core_count": 24\n            },\n            {\n                "frequency": 799,\n                "cpu_usage": 0,\n                "name": "cpu24",\n                "vendor_id": "GenuineIntel",\n                "brand": "13th Gen Intel(R) Core(TM) i9-13900K",\n                "physical_core_count": 24\n            },\n            {\n                "frequency": 2408,\n                "cpu_usage": 0,\n                "name": "cpu25",\n                "vendor_id": "GenuineIntel",\n                "brand": "13th Gen Intel(R) Core(TM) i9-13900K",\n                "physical_core_count": 24\n            },\n            {\n                "frequency": 1329,\n                "cpu_usage": 0,\n                "name": "cpu26",\n                "vendor_id": "GenuineIntel",\n                "brand": "13th Gen Intel(R) Core(TM) i9-13900K",\n                "physical_core_count": 24\n            },\n            {\n                "frequency": 894,\n                "cpu_usage": 0,\n                "name": "cpu27",\n                "vendor_id": "GenuineIntel",\n                "brand": "13th Gen Intel(R) Core(TM) i9-13900K",\n                "physical_core_count": 24\n            },\n            {\n                "frequency": 799,\n                "cpu_usage": 0,\n                "name": "cpu28",\n                "vendor_id": "GenuineIntel",\n                "brand": "13th Gen Intel(R) Core(TM) i9-13900K",\n                "physical_core_count": 24\n            },\n            {\n                "frequency": 2105,\n                "cpu_usage": 0,\n                "name": "cpu29",\n                "vendor_id": "GenuineIntel",\n                "brand": "13th Gen Intel(R) Core(TM) i9-13900K",\n                "physical_core_count": 24\n            },\n            {\n                "frequency": 2458,\n                "cpu_usage": 0,\n                "name": "cpu30",\n                "vendor_id": "GenuineIntel",\n                "brand": "13th Gen Intel(R) Core(TM) i9-13900K",\n                "physical_core_count": 24\n            },\n            {\n                "frequency": 2257,\n                "cpu_usage": 0,\n                "name": "cpu31",\n                "vendor_id": "GenuineIntel",\n                "brand": "13th Gen Intel(R) Core(TM) i9-13900K",\n                "physical_core_count": 24\n            }\n        ],\n        "disks": [\n            {\n                "disk_type": "SSD",\n                "file_system": "btrfs",\n                "mount_point": "/",\n                "total_space": 5511343767552,\n                "available_space": 4759073714176,\n                "removable": false\n            },\n            {\n                "disk_type": "SSD",\n                "file_system": "ext4",\n                "mount_point": "/boot",\n                "total_space": 1020702720,\n                "available_space": 508649472,\n                "removable": false\n            },\n            {\n                "disk_type": "SSD",\n                "file_system": "btrfs",\n                "mount_point": "/home",\n                "total_space": 5511343767552,\n                "available_space": 4759073714176,\n                "removable": false\n            },\n            {\n                "disk_type": "SSD",\n                "file_system": "vfat",\n                "mount_point": "/boot/efi",\n                "total_space": 627875840,\n                "available_space": 607563776,\n                "removable": false\n            }\n        ],\n        "memory": {\n            "available_memory": 114707030016,\n            "free_memory": 77085532160,\n            "free_swap": 8589930496,\n            "total_memory": 134865072128,\n            "total_swap": 8589930496,\n            "used_memory": 20158042112,\n            "used_swap": 0\n        },\n        "interfaces": [\n            {\n                "ip": "10.140.193.26",\n                "mac": "00:00:00:00:00:00",\n                "name": "wg0-mullvad"\n            },\n            {\n                "ip": "fe80::c1f8:451f:35b9:29ce",\n                "mac": "00:00:00:00:00:00",\n                "name": "wg0-mullvad"\n            },\n            {\n                "ip": "fc00:bbbb:bbbb:bb01:d:0:c:c11a",\n                "mac": "00:00:00:00:00:00",\n                "name": "wg0-mullvad"\n            },\n            {\n                "ip": "192.168.1.133",\n                "mac": "04:7c:16:49:b0:38",\n                "name": "enp4s0"\n            },\n            {\n                "ip": "2601:140:827f:9159:d745:92fa:8cd:44b",\n                "mac": "04:7c:16:49:b0:38",\n                "name": "enp4s0"\n            },\n            {\n                "ip": "fda9:dfeb:d274:0:4044:e997:e74d:1b56",\n                "mac": "04:7c:16:49:b0:38",\n                "name": "enp4s0"\n            },\n            {\n                "ip": "fda9:dfeb:d274::a2a",\n                "mac": "04:7c:16:49:b0:38",\n                "name": "enp4s0"\n            },\n            {\n                "ip": "fe80::ccb:fed3:57a3:59b8",\n                "mac": "04:7c:16:49:b0:38",\n                "name": "enp4s0"\n            },\n            {\n                "ip": "2601:140:827f:9159::a2a",\n                "mac": "04:7c:16:49:b0:38",\n                "name": "enp4s0"\n            },\n            {\n                "ip": "127.0.0.1",\n                "mac": "00:00:00:00:00:00",\n                "name": "lo"\n            },\n            {\n                "ip": "::1",\n                "mac": "00:00:00:00:00:00",\n                "name": "lo"\n            }\n        ],\n        "performance": {\n            "avg_one_min": 4.34,\n            "avg_five_min": 3.84,\n            "avg_fifteen_min": 2.29\n        },\n        "version": "0.15.0",\n        "rust_version": "1.87.0",\n        "build_date": "2025-06-17"\n    }\n}\n'})}),"\n",(0,t.jsx)(e.h2,{id:"enrollment-response",children:"Enrollment Response"}),"\n",(0,t.jsx)(e.p,{children:"The artemis daemon expects a response containing the following:"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-json",children:'{\n    "endpoint_id": "a unique ID for our endpoint",\n    "endpoint_invalid": "boolean value to indicate if current endpoint_id is invalid"\n}\n'})}),"\n",(0,t.jsx)(e.p,{children:"An example response is below:"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-json",children:'{\n    "endpoint_id": "3c42b534-107a-4182-b195-04ddcbac9c87",\n    "endpoint_invalid": false\n}\n'})})]})}function u(n={}){const{wrapper:e}={...(0,i.R)(),...n.components};return e?(0,t.jsx)(e,{...n,children:(0,t.jsx)(d,{...n})}):d(n)}},28453:(n,e,r)=>{r.d(e,{R:()=>a,x:()=>s});var o=r(96540);const t={},i=o.createContext(t);function a(n){const e=o.useContext(i);return o.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function s(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(t):n.components||t:a(n.components),o.createElement(i.Provider,{value:e},n.children)}}}]);