"use strict";(globalThis.webpackChunkartemis_docs=globalThis.webpackChunkartemis_docs||[]).push([[4321],{45546(e,n,i){i.r(n),i.d(n,{assets:()=>l,contentTitle:()=>a,default:()=>p,frontMatter:()=>r,metadata:()=>t,toc:()=>c});const t=JSON.parse('{"id":"Intro/Scripting/bundling","title":"Bundling","description":"What is bundling","source":"@site/docs/Intro/Scripting/bundling.md","sourceDirName":"Intro/Scripting","slug":"/Intro/Scripting/bundling","permalink":"/artemis-api/docs/Intro/Scripting/bundling","draft":false,"unlisted":false,"editUrl":"https://github.com/puffyCid/artemis-api/tree/main/artemis-docs/docs/Intro/Scripting/bundling.md","tags":[],"version":"current","lastUpdatedBy":"puffyCid","lastUpdatedAt":1770498354000,"sidebarPosition":3,"frontMatter":{"sidebar_position":3,"description":"What is bundling"},"sidebar":"artemisStart","previous":{"title":"TypeScript","permalink":"/artemis-api/docs/Intro/Scripting/typescript"},"next":{"title":"Step by Step Guide","permalink":"/artemis-api/docs/Intro/Scripting/walkthrough"}}');var s=i(74848),o=i(28453);const r={sidebar_position:3,description:"What is bundling"},a="Bundling",l={},c=[{value:"What is a bundler",id:"what-is-a-bundler",level:2},{value:"Esbuild",id:"esbuild",level:2},{value:"Examples",id:"examples",level:2},{value:"Intermediate",id:"intermediate",level:3},{value:"Advanced",id:"advanced",level:3},{value:"API Documentation",id:"api-documentation",level:2}];function d(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,o.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"bundling",children:"Bundling"})}),"\n",(0,s.jsx)(n.h2,{id:"what-is-a-bundler",children:"What is a bundler"}),"\n",(0,s.jsx)(n.p,{children:"Before we can start creating more powerful scripts, it is important to reviewing bundling."}),"\n",(0,s.jsx)(n.p,{children:"Artemis only supports executing a single script file. This means our entire script must be contained in a single file."}),"\n",(0,s.jsx)(n.p,{children:"So if we want to import the artemis API we need to learn how to use a bundler to help compile our script into a single file."}),"\n",(0,s.jsxs)(n.p,{children:["There are multiple types of bundler applications that can help us with this\ntask. One of the most popular ones is ",(0,s.jsx)(n.a,{href:"https://esbuild.github.io/",children:"esbuild"})]}),"\n",(0,s.jsx)(n.h2,{id:"esbuild",children:"Esbuild"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.a,{href:"https://esbuild.github.io/",children:"esbuild"})," is a popular Bundler for JavaScript. It can be run as a standalone binary on your local development laptop.\nOnce you have esbuild installed you can compile and bundle your TypeScript with the following command:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"esbuild --bundle --outfile=out.js main.ts\n"})}),"\n",(0,s.jsx)(n.p,{children:"The above commands will use the main.ts file and bundle all of its imports into one .js file using esbuild."}),"\n",(0,s.jsxs)(n.admonition,{type:"info",children:[(0,s.jsx)(n.p,{children:"esbuild can also minify JavaScript code! This can dramatically reduce the size of your script"}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"esbuild --bundle --minify --outfile=out.js main.ts\n"})})]}),"\n",(0,s.jsx)(n.h2,{id:"examples",children:"Examples"}),"\n",(0,s.jsx)(n.h3,{id:"intermediate",children:"Intermediate"}),"\n",(0,s.jsx)(n.p,{children:"Lets start using the API!"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["Clone the artemis API repo: ",(0,s.jsx)(n.a,{href:"https://github.com/puffyCid/artemis-api",children:"https://github.com/puffyCid/artemis-api"})]}),"\n",(0,s.jsx)(n.li,{children:"Create the file main.ts and add the following"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:'// Update this path to point to your cloned artemis-api repo\nimport { timeNow } from "./artemis-api/src/time/conversion";\n\nfunction main() {\n  const time_in_seconds = timeNow();\n\n  console.log(`Time in unix epoch seconds: ${time_in_seconds}`);\n}\n\nmain();\n'})}),"\n",(0,s.jsxs)(n.p,{children:["If you hover over the ",(0,s.jsx)(n.code,{children:"timeNow()"})," function your text editor should provide function documentation."]}),"\n",(0,s.jsx)(n.p,{children:"If you try to run the above above code with artemis you will get a similar error as below:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"> artemis -j main.ts \n[artemis] Starting artemis collection!\n01:29:25 [ERROR] [runtime] Could not execute script: JsError { inner: Native(JsNativeError { kind: Syntax, message: \"expected token '.', got '{' in import.meta at line 1, col 8\", cause: None, .. }) }\n[artemis] Finished artemis collection!\n"})}),"\n",(0,s.jsx)(n.p,{children:"Artemis cannot resolve imports! We need to bundle this script and compile to JavaScript."}),"\n",(0,s.jsxs)(n.p,{children:["Using esbuild try the following commands: ",(0,s.jsx)(n.code,{children:"esbuild --bundle --outfile=out.js main.ts"})]}),"\n",(0,s.jsx)(n.p,{children:"You should now have a main.js file in your directory. If you open it in a text editor you should see something similar to below:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-javascript",children:"(() => {\n  // ./artemis-api/src/time/conversion.ts\n  function timeNow() {\n    // This is a Rust function!\n    const data = js_time_now();\n    return Number(data);\n  }\n\n  // main.ts\n  function main() {\n    const time_in_seconds = timeNow();\n    console.log(`Time in unix epoch seconds: ${time_in_seconds}`);\n  }\n  main();\n})();\n"})}),"\n",(0,s.jsx)(n.p,{children:"The bundler took our tiny ~10 line TypeScript file and compiled it to JavaScript and bundled our import!"}),"\n",(0,s.jsx)(n.p,{children:"Now run the main.js file with artemis:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"> artemis -j main.js\n[artemis] Starting artemis collection!\nTime in unix epoch seconds: 1767058428\n[artemis] Finished artemis collection!\n"})}),"\n",(0,s.jsx)(n.h3,{id:"advanced",children:"Advanced"}),"\n",(0,s.jsx)(n.p,{children:"Lets try something a bit more challenging! Lets get a process listing!"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["Clone the artemis API repo: ",(0,s.jsx)(n.a,{href:"https://github.com/puffyCid/artemis-api",children:"https://github.com/puffyCid/artemis-api"})]}),"\n",(0,s.jsx)(n.li,{children:"Create the file main.ts and add the following"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:'import { processListing } from "./artemis-api/mod";\n\nfunction main() {\n  // Get a list of running processes\n  const proc_list = processListing();\n  console.log(`Got ${proc_list.length} processes`);\n\n  console.log(`Looping through processes...`);\n\n  // Loop through each entry\n  for (const entry of proc_list) {\n    console.log(`Process ID ${entry.pid}. Name is ${entry.name}`);\n  }\n}\n\nmain();\n'})}),"\n",(0,s.jsxs)(n.p,{children:["If you hover over the ",(0,s.jsx)(n.code,{children:"processListing()"})," function your text editor should provide function documentation. As you type your text editor should provide property hints and auto complete suggestions."]}),"\n",(0,s.jsxs)(n.p,{children:["Using esbuild try the following commands: ",(0,s.jsx)(n.code,{children:"esbuild --bundle --minify --outfile=out.js main.ts"})]}),"\n",(0,s.jsx)(n.p,{children:"Now run the main.js file with artemis:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"> artemis -j main.js\n[artemis] Starting artemis collection!\nGot 2669 processes\nLooping through processes...\n...\nProcess ID 151. Name is kdevtmpfs\nProcess ID 6323. Name is dbus-broker\nProcess ID 733184. Name is gdbus\nProcess ID 6890. Name is gnome-keyring-d\nProcess ID 3344. Name is chronyd\nProcess ID 8032. Name is mullvad-gui\nProcess ID 372481. Name is syncthing\nProcess ID 691791. Name is node\n...\n[artemis] Finished artemis collection!\n"})}),"\n",(0,s.jsx)(n.h2,{id:"api-documentation",children:"API Documentation"}),"\n",(0,s.jsxs)(n.p,{children:["The most useful API artifacts and functions are exposed in the file ",(0,s.jsx)(n.a,{href:"https://github.com/puffyCid/artemis-api/blob/main/mod.ts",children:"artemis-api/mod.ts"}),". If you import (or view the mod.ts) you have access to nearly all of the API artifacts and parsers."]}),"\n",(0,s.jsx)(n.p,{children:"The API documentation can also be viewed at:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"/artemis-api/docs/API/overview",children:"API Docs"})}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"All artifact properties can be viewed at:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"/artemis-api/docs/Artifacts/overview",children:"Artifacts"})}),"\n"]})]})}function p(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},28453(e,n,i){i.d(n,{R:()=>r,x:()=>a});var t=i(96540);const s={},o=t.createContext(s);function r(e){const n=t.useContext(o);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),t.createElement(o.Provider,{value:n},e.children)}}}]);