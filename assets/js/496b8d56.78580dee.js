"use strict";(self.webpackChunkartemis_docs=self.webpackChunkartemis_docs||[]).push([[4988],{3748:(t,e,n)=>{n.r(e),n.d(e,{assets:()=>l,contentTitle:()=>r,default:()=>h,frontMatter:()=>s,metadata:()=>o,toc:()=>c});var i=n(7624),a=n(2172);const s={description:"The macOS Spotlight database",keywords:["macOS","file meta","binary"]},r="Spotlight",o={id:"Artifacts/macOS Artifacts/spotlight",title:"Spotlight",description:"The macOS Spotlight database",source:"@site/docs/Artifacts/macOS Artifacts/spotlight.md",sourceDirName:"Artifacts/macOS Artifacts",slug:"/Artifacts/macOS Artifacts/spotlight",permalink:"/artemis-api/docs/Artifacts/macOS Artifacts/spotlight",draft:!1,unlisted:!1,editUrl:"https://github.com/puffyCid/artemis-api/tree/main/artemis-docs/docs/Artifacts/macOS Artifacts/spotlight.md",tags:[],version:"current",frontMatter:{description:"The macOS Spotlight database",keywords:["macOS","file meta","binary"]},sidebar:"artemisArtifacts",previous:{title:"Shell History",permalink:"/artemis-api/docs/Artifacts/macOS Artifacts/shellhistory"},next:{title:"Sudo Logs",permalink:"/artemis-api/docs/Artifacts/macOS Artifacts/sudo"}},l={},c=[];function d(t){const e={a:"a",br:"br",code:"code",h1:"h1",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,a.M)(),...t.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(e.h1,{id:"spotlight",children:"Spotlight"}),"\n",(0,i.jsxs)(e.p,{children:["macOS ",(0,i.jsx)(e.code,{children:"Spotlight"})," is an indexing service for tracking files and content. The\n",(0,i.jsx)(e.code,{children:"Spotlight"})," database can contain a huge amount of metadata associated with the\nindexed content such as:"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"Timestamps"}),"\n",(0,i.jsx)(e.li,{children:"Partial file content"}),"\n",(0,i.jsx)(e.li,{children:"File type and much more"}),"\n"]}),"\n",(0,i.jsxs)(e.p,{children:["The primary database is typically located at the root of the macOS Data volume.",(0,i.jsx)(e.br,{}),"\n","ex: /System/Volumes/Data/.Spotlight-V100/Store-V3/123-445566-778-12384/"]}),"\n",(0,i.jsx)(e.p,{children:"By default artemis will only attempt to parse the Spotlight database located at\nthe Data volume"}),"\n",(0,i.jsx)(e.p,{children:"However, additional databases can also be found on the macOS system. Known\nadditional locations are:"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"/Users/*/Library/Caches/com.apple.helpd/index.spotlightV*/*"}),"\n",(0,i.jsx)(e.li,{children:"/Users/*/Library/Metadata/CoreSpotlight/index.spotlightV*/*"}),"\n",(0,i.jsx)(e.li,{children:"/Users/*/Library/Developer/Xcode/DocumentationCache/*/*/DeveloperDocumentation.index/*"}),"\n",(0,i.jsx)(e.li,{children:"/Users/*/Library/Metadata/CoreSpotlight/*/index.spotlightV*/*"}),"\n",(0,i.jsx)(e.li,{children:"/Users/*/Library/Caches/com.apple.helpd/*/index.spotlightV*/*"}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"Similar to the filelisting artifact, every 10k entries artemis will output the\ndata and continue."}),"\n",(0,i.jsx)(e.p,{children:"Other Parsers:"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.a,{href:"https://github.com/ydkhatri/spotlight_parser",children:"spotlight_parser"})}),"\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.a,{href:"https://github.com/ydkhatri/mac_apt",children:"mac_apt"})}),"\n"]}),"\n",(0,i.jsx)(e.p,{children:"References:"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.a,{href:"https://forensicsandsecurity.com/papers/SpotlightMacForensicsSlides.pdf",children:"Forensic and Security"})}),"\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.a,{href:"https://en.wikipedia.org/wiki/Spotlight_(Apple)",children:"Spotlight"})}),"\n",(0,i.jsx)(e.li,{children:(0,i.jsx)(e.a,{href:"https://github.com/libyal/dtformats/blob/main/documentation/Apple%20Spotlight%20store%20database%20file%20format.asciidoc",children:"libyal"})}),"\n"]}),"\n",(0,i.jsx)(e.h1,{id:"toml-collection",children:"TOML Collection"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-toml",children:'system = "macos"\n\n[output]\nname = "spotlight_collection"\ndirectory = "./tmp"\nformat = "jsonl"\ncompress = false\nendpoint_id = "abdc"\ncollection_id = 1\noutput = "local"\n\n[[artifacts]]\nartifact_name = "spotlight"\n[artifacts.spotlight]\n# Optional\n# alt_path = ""\n\n# Include additional known Spotlight paths such as\n#     /Users/*/Library/Caches/com.apple.helpd/index.spotlightV*/*\n#     /Users/*/Library/Metadata/CoreSpotlight/index.spotlightV*/*\n#     /Users/*/Library/Developer/Xcode/DocumentationCache/*/*/DeveloperDocumentation.index/*\n#     /Users/*/Library/Metadata/CoreSpotlight/*/index.spotlightV*/*\n#     /Users/*/Library/Caches/com.apple.helpd/*/index.spotlightV*/*\n# This is optional. Default is false\ninclude_additional = true\n'})}),"\n",(0,i.jsx)(e.h1,{id:"collection-options",children:"Collection Options"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"alt_path"})," Alternative path to a Spotlight database. This configuration is\n",(0,i.jsx)(e.strong,{children:"optional"})]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"include_additional"})," Artemis will parse additional known Spotlight database\nlocations. This configuration is ",(0,i.jsx)(e.strong,{children:"optional"})]}),"\n"]}),"\n",(0,i.jsx)(e.h1,{id:"output-structure",children:"Output Structure"}),"\n",(0,i.jsxs)(e.p,{children:["An array of ",(0,i.jsx)(e.code,{children:"Spotlight"})," entries"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-typescript",children:"export interface Spotlight {\n  /**Inode number associated with indexed file */\n  inode: bigint;\n  /**Parent inode associated with indexed file */\n  parent_inode: bigint;\n  /**Flags associated with indexed entry */\n  flags: number;\n  /**Store ID associated with indexed entry */\n  store_id: number;\n  /**Last time Spotlight entry was updated in UNIXEPOCH **microseconds** */\n  last_updated: bigint;\n  /**Array of properties associated with the entry */\n  values: Record<string, SpotlightProperties>[];\n  /**Location of the Spotlight database that was parsed */\n  directory: string;\n}\n\n/**\n * Properties associated with the indexed entry\n */\ninterface SpotlightProperties {\n  /**\n   * Attribute type associated with the entry.\n   * Possible options are:\n   * - AttrBool\n   * - AttrUnknown\n   * - AttrVariableSizeInt\n   * - AttrUnknown2\n   * - AttrUnknown3\n   * - AttrUnknown4\n   * - AttrVariableSizeInt2\n   * - AttrVariableSizeIntMultiValue\n   * - AttrByte\n   * - AttrFloat32\n   * - AttrFloat64\n   * - AttrString\n   * - AttrDate (typically will be number of seconds in UNIXEPOCH)\n   * - AttrBinary\n   * - AttrList\n   * - Unknown\n   */\n  attribute: DataAttribute;\n  /**\n   * Data associated with the property. Type can be determined based on the attribute.\n   * **Important** `value` may also be an array containting data associated with the `attribute`\n   */\n  value: unknown;\n}\n"})})]})}function h(t={}){const{wrapper:e}={...(0,a.M)(),...t.components};return e?(0,i.jsx)(e,{...t,children:(0,i.jsx)(d,{...t})}):d(t)}},2172:(t,e,n)=>{n.d(e,{I:()=>o,M:()=>r});var i=n(1504);const a={},s=i.createContext(a);function r(t){const e=i.useContext(s);return i.useMemo((function(){return"function"==typeof t?t(e):{...e,...t}}),[e,t])}function o(t){let e;return e=t.disableParentContext?"function"==typeof t.components?t.components(a):t.components||a:r(t.components),i.createElement(s.Provider,{value:e},t.children)}}}]);