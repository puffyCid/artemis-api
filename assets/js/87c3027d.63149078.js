"use strict";(globalThis.webpackChunkartemis_docs=globalThis.webpackChunkartemis_docs||[]).push([[9441],{28453:(i,t,e)=>{e.d(t,{R:()=>r,x:()=>a});var s=e(96540);const c={},n=s.createContext(c);function r(i){const t=s.useContext(n);return s.useMemo(function(){return"function"==typeof i?i(t):{...t,...i}},[t,i])}function a(i){let t;return t=i.disableParentContext?"function"==typeof i.components?i.components(c):i.components||c:r(i.components),s.createElement(n.Provider,{value:t},i.children)}},60464:(i,t,e)=>{e.r(t),e.d(t,{assets:()=>o,contentTitle:()=>a,default:()=>p,frontMatter:()=>r,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"Intro/Scripting/scripts","title":"Scripts","description":"Creating a script","source":"@site/docs/Intro/Scripting/scripts.md","sourceDirName":"Intro/Scripting","slug":"/Intro/Scripting/scripts","permalink":"/artemis-api/docs/Intro/Scripting/scripts","draft":false,"unlisted":false,"editUrl":"https://github.com/puffyCid/artemis-api/tree/main/artemis-docs/docs/Intro/Scripting/scripts.md","tags":[],"version":"current","lastUpdatedBy":"puffyCid","lastUpdatedAt":1767053808000,"sidebarPosition":5,"frontMatter":{"sidebar_position":5,"description":"Creating a script"},"sidebar":"artemisStart","previous":{"title":"Filtering","permalink":"/artemis-api/docs/Intro/Scripting/filterscripts"},"next":{"title":"Limitations","permalink":"/artemis-api/docs/Intro/Scripting/limitations"}}');var c=e(74848),n=e(28453);const r={sidebar_position:5,description:"Creating a script"},a="Scripts",o={},d=[{value:"Collection Options",id:"collection-options",level:2}];function l(i){const t={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,n.R)(),...i.components};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(t.header,{children:(0,c.jsx)(t.h1,{id:"scripts",children:"Scripts"})}),"\n",(0,c.jsx)(t.p,{children:"The easiest way to start scripting is to create a TypeScript project."}),"\n",(0,c.jsxs)(t.ul,{children:["\n",(0,c.jsx)(t.li,{children:"Create a new directory that will contain out TypeScript code"}),"\n"]}),"\n",(0,c.jsxs)(t.p,{children:["Since we are using a runtime built specifically for DFIR all scripts must import the\n",(0,c.jsx)(t.a,{href:"https://github.com/puffyCid/artemis-api",children:"artemis-api"})," modules in order to\neffectively create scripts."]}),"\n",(0,c.jsxs)(t.p,{children:["Remember, since theis is a custom JS runtime, we will only have access the\nvanilla\n",(0,c.jsx)(t.a,{href:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects",children:"JavaScript"}),"\nAPI and the ",(0,c.jsx)(t.a,{href:"https://github.com/puffyCid/artemis-api",children:"artemis-api"})," for scripting"]}),"\n",(0,c.jsx)(t.p,{children:"To import artemis functions into your script, create a main.ts file and import the\nfunction associated with the artifact you want to parse. For example, to parse\nthe Windows Registry you would import:"}),"\n",(0,c.jsx)(t.pre,{children:(0,c.jsx)(t.code,{className:"language-typescript",children:'import { getRegistry } from "./artemis-api/mod";\n'})}),"\n",(0,c.jsx)(t.p,{children:"If you wanted to parse the Windows Registry and manipulate the parsed data you\nwould import:"}),"\n",(0,c.jsx)(t.pre,{children:(0,c.jsx)(t.code,{className:"language-typescript",children:'import { getRegistry } from "./artemis-api/mod";\nimport { Registry } from "./artemis-api/src/windows/registry";\n'})}),"\n",(0,c.jsxs)(t.p,{children:["A list of all exported artemis functions can be found at\n",(0,c.jsx)(t.a,{href:"https://github.com/puffyCid/artemis-api",children:"https://github.com/puffyCid/artemis-api"}),". All artifacts supported by artemis are\ncallable from TypeScript. The structured output produced by each artifact is\nlisted in the respective artifact section. For example, the structured Registry\noutput returned by ",(0,c.jsx)(t.code,{children:"getRegistry"})," is found in the\n",(0,c.jsx)(t.a,{href:"/artemis-api/docs/Artifacts/Windows%20Artfacts/registry",children:"Registry artifact"})]}),"\n",(0,c.jsx)(t.p,{children:"Once we have created and bundled our script. We just need to base64 encode\nbefore providing it to artemis."}),"\n",(0,c.jsx)(t.h1,{id:"toml-collection",children:"TOML Collection"}),"\n",(0,c.jsx)(t.p,{children:"An example TOML collection would like this"}),"\n",(0,c.jsx)(t.pre,{children:(0,c.jsx)(t.code,{className:"language-toml",children:'[output]\nname = "plist_data"\ndirectory = "./tmp"\nformat = "json"\ncompress = false\nendpoint_id = "6c51b123-1522-4572-9f2a-0bd5abd81b82"\ncollection_id = 1\noutput = "local"\ntimeline = false\n\n[[artifacts]]\nartifact_name = "script"\n[artifacts.script]\nname = "all_users_plist_files"\n# Parses all plist files in /Users/%\nscript = "Ly8gaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL3B1ZmZ5Y2lkL2FydGVtaXMtYXBpL21hc3Rlci9zcmMvbWFjb3MvcGxpc3QudHMKZnVuY3Rpb24gZ2V0UGxpc3QocGF0aCkgewogIGNvbnN0IGRhdGEgPSBEZW5vLmNvcmUub3BzLmdldF9wbGlzdChwYXRoKTsKICBpZiAoZGF0YSA9PT0gIiIpIHsKICAgIHJldHVybiBudWxsOwogIH0KICBjb25zdCBwbGlzdF9kYXRhID0gSlNPTi5wYXJzZShkYXRhKTsKICByZXR1cm4gcGxpc3RfZGF0YTsKfQoKLy8gaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL3B1ZmZ5Y2lkL2FydGVtaXMtYXBpL21hc3Rlci9zcmMvc3lzdGVtL291dHB1dC50cwpmdW5jdGlvbiBvdXRwdXRSZXN1bHRzKGRhdGEsIGRhdGFfbmFtZSwgb3V0cHV0KSB7CiAgY29uc3Qgb3V0cHV0X3N0cmluZyA9IEpTT04uc3RyaW5naWZ5KG91dHB1dCk7CiAgY29uc3Qgc3RhdHVzID0gRGVuby5jb3JlLm9wcy5vdXRwdXRfcmVzdWx0cygKICAgIGRhdGEsCiAgICBkYXRhX25hbWUsCiAgICBvdXRwdXRfc3RyaW5nCiAgKTsKICByZXR1cm4gc3RhdHVzOwp9CgovLyBodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vcHVmZnljaWQvYXJ0ZW1pcy1hcGkvbWFzdGVyL3NyYy9maWxlc3lzdGVtL2RpcmVjdG9yeS50cwphc3luYyBmdW5jdGlvbiByZWFkRGlyKHBhdGgpIHsKICBjb25zdCBkYXRhID0gSlNPTi5wYXJzZShhd2FpdCBmcy5yZWFkRGlyKHBhdGgpKTsKICByZXR1cm4gZGF0YTsKfQoKLy8gbWFpbi50cwphc3luYyBmdW5jdGlvbiBtYWluKCkgewogIGNvbnN0IHN0YXJ0X3BhdGggPSAiL1VzZXJzIjsKICBjb25zdCBwbGlzdF9maWxlcyA9IFtdOwogIGF3YWl0IHJlY3Vyc2VfZGlyKHBsaXN0X2ZpbGVzLCBzdGFydF9wYXRoKTsKICByZXR1cm4gcGxpc3RfZmlsZXM7Cn0KYXN5bmMgZnVuY3Rpb24gcmVjdXJzZV9kaXIocGxpc3RfZmlsZXMsIHN0YXJ0X3BhdGgpIHsKICBpZiAocGxpc3RfZmlsZXMubGVuZ3RoID4gMjApIHsKICAgIGNvbnN0IG91dCA9IHsKICAgICAgbmFtZTogImFydGVtaXNfcGxpc3QiLAogICAgICBkaXJlY3Rvcnk6ICIuL3RtcCIsCiAgICAgIGZvcm1hdDogImpzb24iIC8qIEpTT04gKi8sCiAgICAgIGNvbXByZXNzOiBmYWxzZSwKICAgICAgZW5kcG9pbnRfaWQ6ICJhbnl0aGluZy1pLXdhbnQiLAogICAgICBjb2xsZWN0aW9uX2lkOiAxLAogICAgICBvdXRwdXQ6ICJsb2NhbCIgLyogTE9DQUwgKi8KICAgIH07CiAgICBjb25zdCBzdGF0dXMgPSBvdXRwdXRSZXN1bHRzKAogICAgICBKU09OLnN0cmluZ2lmeShwbGlzdF9maWxlcyksCiAgICAgICJhcnRlbWlzX2luZm8iLAogICAgICBvdXQKICAgICk7CiAgICBpZiAoIXN0YXR1cykgewogICAgICBjb25zb2xlLmxvZygiQ291bGQgbm90IG91dHB1dCB0byBsb2NhbCBkaXJlY3RvcnkiKTsKICAgIH0KICAgIHBsaXN0X2ZpbGVzID0gW107CiAgfQogIGZvciAoY29uc3QgZW50cnkgb2YgYXdhaXQgcmVhZERpcihzdGFydF9wYXRoKSkgewogICAgY29uc3QgcGxpc3RfcGF0aCA9IGAke3N0YXJ0X3BhdGh9LyR7ZW50cnkuZmlsZW5hbWV9YDsKICAgIGlmIChlbnRyeS5pc19maWxlICYmIGVudHJ5LmZpbGVuYW1lLmVuZHNXaXRoKCJwbGlzdCIpKSB7CiAgICAgIGNvbnN0IGRhdGEgPSBnZXRQbGlzdChwbGlzdF9wYXRoKTsKICAgICAgaWYgKGRhdGEgPT09IG51bGwpIHsKICAgICAgICBjb250aW51ZTsKICAgICAgfQogICAgICBjb25zdCBwbGlzdF9pbmZvID0gewogICAgICAgIHBsaXN0X2NvbnRlbnQ6IGRhdGEsCiAgICAgICAgZmlsZTogcGxpc3RfcGF0aAogICAgICB9OwogICAgICBwbGlzdF9maWxlcy5wdXNoKHBsaXN0X2luZm8pOwogICAgICBjb250aW51ZTsKICAgIH0KICAgIGlmIChlbnRyeS5pc19kaXJlY3RvcnkpIHsKICAgICAgYXdhaXQgcmVjdXJzZV9kaXIocGxpc3RfZmlsZXMsIHBsaXN0X3BhdGgpOwogICAgfQogIH0KfQptYWluKCk7Cg=="\n'})}),"\n",(0,c.jsx)(t.h2,{id:"collection-options",children:"Collection Options"}),"\n",(0,c.jsxs)(t.ul,{children:["\n",(0,c.jsx)(t.li,{children:"name: Name for script"}),"\n",(0,c.jsx)(t.li,{children:"script: Base64 encoded bundled script (JavaScript)"}),"\n"]}),"\n",(0,c.jsx)(t.h1,{id:"cli-collection",children:"CLI Collection"}),"\n",(0,c.jsx)(t.p,{children:"You may also provide a bundled JavaScript directly to the artemis cli binary."}),"\n",(0,c.jsx)(t.p,{children:"You can execute JavaScript code with the following command:"}),"\n",(0,c.jsxs)(t.ul,{children:["\n",(0,c.jsx)(t.li,{children:"artemis - j ./path/to/script.js"}),"\n"]})]})}function p(i={}){const{wrapper:t}={...(0,n.R)(),...i.components};return t?(0,c.jsx)(t,{...i,children:(0,c.jsx)(l,{...i})}):l(i)}}}]);