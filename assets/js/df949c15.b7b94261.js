"use strict";(self.webpackChunkartemis_docs=self.webpackChunkartemis_docs||[]).push([[3523],{3905:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>f});var a=n(7294);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var s=a.createContext({}),c=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},p=function(e){var t=c(e.components);return a.createElement(s.Provider,{value:t},e.children)},m="mdxType",u={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},d=a.forwardRef((function(e,t){var n=e.components,i=e.mdxType,r=e.originalType,s=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),m=c(n),d=i,f=m["".concat(s,".").concat(d)]||m[d]||u[d]||r;return n?a.createElement(f,o(o({ref:t},p),{},{components:n})):a.createElement(f,o({ref:t},p))}));function f(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var r=n.length,o=new Array(r);o[0]=d;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l[m]="string"==typeof e?e:i,o[1]=l;for(var c=2;c<r;c++)o[c]=n[c];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}d.displayName="MDXCreateElement"},3044:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>o,default:()=>u,frontMatter:()=>r,metadata:()=>l,toc:()=>c});var a=n(7462),i=(n(7294),n(3905));const r={sidebar_position:2,description:"The TOML collection format"},o="Format",l={unversionedId:"Intro/Collections/format",id:"Intro/Collections/format",title:"Format",description:"The TOML collection format",source:"@site/docs/Intro/Collections/format.md",sourceDirName:"Intro/Collections",slug:"/Intro/Collections/format",permalink:"/artemis-api/docs/Intro/Collections/format",draft:!1,editUrl:"https://github.com/puffyCid/artemis-api/tree/main/artemis-docs/docs/Intro/Collections/format.md",tags:[],version:"current",sidebarPosition:2,frontMatter:{sidebar_position:2,description:"The TOML collection format"},sidebar:"artemisStart",previous:{title:"Overview",permalink:"/artemis-api/docs/Intro/Collections/overview"},next:{title:"Output Formats",permalink:"/artemis-api/docs/Intro/Collections/output"}},s={},c=[],p={toc:c},m="wrapper";function u(e){let{components:t,...n}=e;return(0,i.kt)(m,(0,a.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"format"},"Format"),(0,i.kt)("p",null,"An example TOML collection is provided below:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-toml"},'system = "windows"\n\n[output]\nname = "amcache_collection"\ndirectory = "./tmp"\nformat = "json"\ncompress = false\nendpoint_id = "6c51b123-1522-4572-9f2a-0bd5abd81b82"\ncollection_id = 1\noutput = "local"\nurl = ""\napi_key = ""\nfilter_name = ""\nfilter_script = ""\nlogging = "warn"\n\n[[artifacts]]\nartifact_name = "amcache"\nfilter = true\n[artifacts.amcache]\n# Optional\n# alt_drive = \'C\'\n')),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"system")," Defines what OS this collection targets. This example targets\n",(0,i.kt)("inlineCode",{parentName:"li"},"windows")," systems. This collection will only run with the Windows version of\nartemis"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"[output]")," Defines the output configuration",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"name")," The output name. This can be any string value"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"directory")," The directory where the output should be written. This example\noutputs to a directory called ",(0,i.kt)("inlineCode",{parentName:"li"},"tmp")," in the current working directory"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"format")," The output format can be either ",(0,i.kt)("inlineCode",{parentName:"li"},"json")," or ",(0,i.kt)("inlineCode",{parentName:"li"},"jsonl")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"compress")," Whether to compress the output with ",(0,i.kt)("inlineCode",{parentName:"li"},"gzip")," compression. Once the\ncollection is complete the output directory will be compressed with ",(0,i.kt)("inlineCode",{parentName:"li"},"zip"),"\ncompression."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"endpoint_id")," An ID assigned to the endpoint. This can be any string value"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"collection_id")," A number assigned to the collection. This can be any postive\nnumber"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"output")," The output type. Supports: ",(0,i.kt)("inlineCode",{parentName:"li"},"local, gcp, aws, or azure")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"url")," The URL associated with either ",(0,i.kt)("inlineCode",{parentName:"li"},"gcp, aws, or azure"),". This is required\nonly if using ",(0,i.kt)("strong",{parentName:"li"},"remote upload")," output"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"api_key")," The API key associated with either ",(0,i.kt)("inlineCode",{parentName:"li"},"gcp, aws, or azure"),". This is\nrequired only if using ",(0,i.kt)("strong",{parentName:"li"},"remote upload")," output"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"filter_name")," The name of the provided ",(0,i.kt)("inlineCode",{parentName:"li"},"filter_script"),". This is ",(0,i.kt)("strong",{parentName:"li"},"optional"),"\nbut if you are using a ",(0,i.kt)("inlineCode",{parentName:"li"},"filter_script")," you should provide a name. Otherwise\nthe default name ",(0,i.kt)("inlineCode",{parentName:"li"},"UnknownFilterName")," is used"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"filter_script")," An advanced ",(0,i.kt)("strong",{parentName:"li"},"optional")," output option, will pass the\nresults of each ",(0,i.kt)("inlineCode",{parentName:"li"},"[[artifacts]]")," entry into a script. See\n",(0,i.kt)("a",{parentName:"li",href:"/artemis-api/docs/Intro/Scripting/deno"},"scripting")," section for detailed overview of this\noption."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"logging")," Set the logging level for artemis. This is ",(0,i.kt)("strong",{parentName:"li"},"optional")," by default\nartemis will log errors and warnings. Valid options are:\n",(0,i.kt)("inlineCode",{parentName:"li"},"warn, error, debug, or info")))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"[[artifacts]]")," A list of artifacts to collect",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"artifact_name")," Name of aritfact"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"filter")," Whether to filter the artifact data through the ",(0,i.kt)("inlineCode",{parentName:"li"},"filter_script"),".\nThis is ",(0,i.kt)("strong",{parentName:"li"},"optional")," by default nothing is filtered"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"[aritfacts.amcache]")," Artifact configuration parameters",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"alt_drive")," Use an alternative drive when collecting data. This parameter\nis optional")))))),(0,i.kt)("p",null,"The example above collects one artifact (",(0,i.kt)("inlineCode",{parentName:"p"},"Amcache"),") on a Windows system and\noutputs the results the local system at the path ",(0,i.kt)("inlineCode",{parentName:"p"},"./tmp/amcache_collection")),(0,i.kt)("p",null,"If we wanted to collect more than one artifact we could use a collection like\nthe one below:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-toml"},'system = "windows"\n\n[output]\nname = "execution_collection"\ndirectory = "./tmp"\nformat = "jsonl"\ncompress = false\nendpoint_id = "6c51b123-1522-4572-9f2a-0bd5abd81b82"\ncollection_id = 1\noutput = "local"\n\n[[artifacts]]\nartifact_name = "amcache"\n[artifacts.amcache]\n\n[[artifacts]]\nartifact_name = "shortcuts"\n[artifacts.shortcuts]\npath = "C:\\\\ProgramData\\\\Microsoft\\\\Windows\\\\Start Menu\\\\Programs\\\\Startup"\n')),(0,i.kt)("p",null,"The TOML collection above collects both ",(0,i.kt)("inlineCode",{parentName:"p"},"amcache")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"shortcuts")," data on a\nWindows system and outputs the results to the local system at the path\n",(0,i.kt)("inlineCode",{parentName:"p"},"./tmp/execution_collection"),"."),(0,i.kt)("p",null,"Notable changes:",(0,i.kt)("br",null)," ",(0,i.kt)("inlineCode",{parentName:"p"},"name")," our collection is now named ",(0,i.kt)("inlineCode",{parentName:"p"},"execution_collection")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-toml"},'[[artifacts]]\nartifact_name = "amcache"\n[artifacts.amcache]\n')),(0,i.kt)("p",null,"Since the ",(0,i.kt)("inlineCode",{parentName:"p"},"alt_drive")," parameter is optional for ",(0,i.kt)("inlineCode",{parentName:"p"},"amcache")," we do not need to\nspecifiy it"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-toml"},'[[artifacts]]\nartifact_name = "shortcuts"\n[artifacts.shortcuts]\npath = "C:\\\\ProgramData\\\\Microsoft\\\\Windows\\\\Start Menu\\\\Programs\\\\Startup"\n')),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"[[artifacts]]")," The second entry in our list of artifacts to collect",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"artifact_name")," Name of aritfact"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"[aritfacts.shortcuts]")," Artifact configuration parameters",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"path")," Use the provided path to collect ",(0,i.kt)("inlineCode",{parentName:"li"},"shortcuts")," data. This parameter\nis ",(0,i.kt)("strong",{parentName:"li"},"required"))))))),(0,i.kt)("p",null,"Since ",(0,i.kt)("inlineCode",{parentName:"p"},"[[artifacts]]")," is a list we can even provide the same artifact multiple\ntimes:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-toml"},'[[artifacts]]\nartifact_name = "shortcuts"\n[artifacts.shortcuts]\npath = "C:\\\\ProgramData\\\\Microsoft\\\\Windows\\\\Start Menu\\\\Programs\\\\Startup"\n\n[[artifacts]]\nartifact_name = "shortcuts"\n[artifacts.shortcuts]\npath = "D:\\\\ProgramData\\\\Microsoft\\\\Windows\\\\Start Menu\\\\Programs\\\\Startup"\n\n[[artifacts]]\nartifact_name = "shortcuts"\n[artifacts.shortcuts]\npath = "E:\\\\Users\\\\rust\\\\Downloads"\n')),(0,i.kt)("p",null,"However, providing the same artifact mutliple times can be repetitive. See the\nchapter on ",(0,i.kt)("a",{parentName:"p",href:"/artemis-api/docs/Intro/Scripting/deno"},"scripting")," to see how we can automate and\nenhance artifact collection using artemis and a tiny amount of JavaScript!"),(0,i.kt)("p",null,"Finally you can review the full list of all supported artifacts and their\nconfiguration under the ",(0,i.kt)("a",{parentName:"p",href:"/artemis-api/docs/Artifacts/overview"},"artifact")," chapter"))}u.isMDXComponent=!0}}]);