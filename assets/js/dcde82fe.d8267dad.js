"use strict";(globalThis.webpackChunkartemis_docs=globalThis.webpackChunkartemis_docs||[]).push([[4448],{28453:(n,t,e)=>{e.d(t,{R:()=>r,x:()=>l});var i=e(96540);const s={},o=i.createContext(s);function r(n){const t=i.useContext(o);return i.useMemo(function(){return"function"==typeof n?n(t):{...t,...n}},[t,n])}function l(n){let t;return t=n.disableParentContext?"function"==typeof n.components?n.components(s):n.components||s:r(n.components),i.createElement(o.Provider,{value:t},n.children)}},43770:(n,t,e)=>{e.r(t),e.d(t,{assets:()=>a,contentTitle:()=>l,default:()=>u,frontMatter:()=>r,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"Artifacts/Linux Artifacts/logons","title":"Logons","description":"Linux logon info","source":"@site/docs/Artifacts/Linux Artifacts/logons.md","sourceDirName":"Artifacts/Linux Artifacts","slug":"/Artifacts/Linux Artifacts/logons","permalink":"/artemis-api/docs/Artifacts/Linux Artifacts/logons","draft":false,"unlisted":false,"editUrl":"https://github.com/puffyCid/artemis-api/tree/main/artemis-docs/docs/Artifacts/Linux Artifacts/logons.md","tags":[],"version":"current","lastUpdatedBy":"puffyCid","lastUpdatedAt":1767062193000,"frontMatter":{"description":"Linux logon info","keywords":["linux","binary","sqlite"]},"sidebar":"artemisArtifacts","previous":{"title":"Kate","permalink":"/artemis-api/docs/Artifacts/Linux Artifacts/kate"},"next":{"title":"Processes","permalink":"/artemis-api/docs/Artifacts/Linux Artifacts/processes"}}');var s=e(74848),o=e(28453);const r={description:"Linux logon info",keywords:["linux","binary","sqlite"]},l="Logons",a={},c=[];function d(n){const t={a:"a",code:"code",h1:"h1",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...n.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.header,{children:(0,s.jsx)(t.h1,{id:"logons",children:"Logons"})}),"\n",(0,s.jsxs)(t.p,{children:["Linux stores ",(0,s.jsx)(t.code,{children:"Logon"})," information in several different files depending on the\ndistro and software installed. Typically the following files contain logon\ninformation on Linux:"]}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"wtmp - Historical logons"}),"\n",(0,s.jsx)(t.li,{children:"btmp - Failed logons"}),"\n",(0,s.jsx)(t.li,{children:"utmp - Users currently logged on"}),"\n",(0,s.jsx)(t.li,{children:"wtmp.db - Historical logons (Requires Artemis API)"}),"\n"]}),"\n",(0,s.jsx)(t.p,{children:"Other Parsers:"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"N/A"}),"\n"]}),"\n",(0,s.jsx)(t.p,{children:"References:"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:(0,s.jsx)(t.a,{href:"https://github.com/libyal/dtformats/blob/main/documentation/Utmp%20login%20records%20format.asciidoc",children:"libyal"})}),"\n",(0,s.jsx)(t.li,{children:(0,s.jsx)(t.a,{href:"https://man7.org/linux/man-pages/man5/utmp.5.html",children:"utmp"})}),"\n"]}),"\n",(0,s.jsx)(t.h1,{id:"toml-collection",children:"TOML Collection"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-toml",children:'[output]\nname = "logon_collection"\ndirectory = "./tmp"\nformat = "json"\ncompress = false\nendpoint_id = "abdc"\ncollection_id = 1\noutput = "local"\ntimeline = false\n\n[[artifacts]]\nartifact_name = "logons"\n[artifacts.logons]\n# Optional\n# alt_file = ""\n'})}),"\n",(0,s.jsx)(t.h1,{id:"collection-options",children:"Collection Options"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"alt_file"})," An alternative path to a wtmp, utmp, or btmp file. This\nconfiguration is ",(0,s.jsx)(t.strong,{children:"optional"})]}),"\n"]}),"\n",(0,s.jsx)(t.h1,{id:"output-structure",children:"Output Structure"}),"\n",(0,s.jsxs)(t.p,{children:["An array of ",(0,s.jsx)(t.code,{children:"Logon"})," entries"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-typescript",children:'export interface Logon {\n  /**Logon type for logon entry */\n  logon_type: string;\n  /**Process ID */\n  pid: number;\n  /** Terminal info */\n  terminal: string;\n  /**Terminal ID for logon entry */\n  terminal_id: number;\n  /**Username for logon */\n  username: string;\n  /**Hostname for logon source */\n  hostname: string;\n  /**Termination status for logon entry */\n  termination_status: number;\n  /**Exit status logon entry */\n  exit_status: number;\n  /**Session for logon entry */\n  session: number;\n  /**Timestamp for logon */\n  timestamp: string;\n  /**Microseconds for logon */\n  microseconds: number;\n  /**Source IP for logon entry */\n  ip: string;\n  /**Status of logon entry: `Success` or `Failed` */\n  status: string;\n}\n\nAn array of `LastLogons` entries when querying the wtmp.db file\n\nexport interface LastLogons {\n    id: number;\n    type: number;\n    user: string;\n    login: string;\n    logout: string;\n    tty: string;\n    remote: string;\n    service: string;\n    message: string;\n    datetime: string;\n    timestamp_desc: "User Logon";\n    artifact: "wtmpdb Logons";\n    data_type: "linux:wtmpdb:entry";\n}\n'})})]})}function u(n={}){const{wrapper:t}={...(0,o.R)(),...n.components};return t?(0,s.jsx)(t,{...n,children:(0,s.jsx)(d,{...n})}):d(n)}}}]);