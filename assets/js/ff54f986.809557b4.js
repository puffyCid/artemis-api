"use strict";(self.webpackChunkartemis_docs=self.webpackChunkartemis_docs||[]).push([[7033],{3905:(e,t,n)=>{n.d(t,{Zo:()=>d,kt:()=>f});var a=n(7294);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var s=a.createContext({}),p=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):r(r({},t),e)),n},d=function(e){var t=p(e.components);return a.createElement(s.Provider,{value:t},e.children)},m="mdxType",c={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},u=a.forwardRef((function(e,t){var n=e.components,i=e.mdxType,o=e.originalType,s=e.parentName,d=l(e,["components","mdxType","originalType","parentName"]),m=p(n),u=i,f=m["".concat(s,".").concat(u)]||m[u]||c[u]||o;return n?a.createElement(f,r(r({ref:t},d),{},{components:n})):a.createElement(f,r({ref:t},d))}));function f(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var o=n.length,r=new Array(o);r[0]=u;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l[m]="string"==typeof e?e:i,r[1]=l;for(var p=2;p<o;p++)r[p]=n[p];return a.createElement.apply(null,r)}return a.createElement.apply(null,n)}u.displayName="MDXCreateElement"},7567:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>r,default:()=>c,frontMatter:()=>o,metadata:()=>l,toc:()=>p});var a=n(7462),i=(n(7294),n(3905));const o={sidebar_position:3,description:"Supported output formats"},r="Output Formats",l={unversionedId:"Intro/Collections/output",id:"Intro/Collections/output",title:"Output Formats",description:"Supported output formats",source:"@site/docs/Intro/Collections/output.md",sourceDirName:"Intro/Collections",slug:"/Intro/Collections/output",permalink:"/artemis-api/docs/Intro/Collections/output",draft:!1,editUrl:"https://github.com/puffyCid/artemis-api/tree/main/artemis-docs/docs/Intro/Collections/output.md",tags:[],version:"current",sidebarPosition:3,frontMatter:{sidebar_position:3,description:"Supported output formats"},sidebar:"artemisStart",previous:{title:"Format",permalink:"/artemis-api/docs/Intro/Collections/format"},next:{title:"Remote Uploads",permalink:"/artemis-api/docs/Intro/Collections/uploads"}},s={},p=[],d={toc:p},m="wrapper";function c(e){let{components:t,...n}=e;return(0,i.kt)(m,(0,a.Z)({},d,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"output-formats"},"Output Formats"),(0,i.kt)("p",null,"artemis supports two (2) types of output formats:\n",(0,i.kt)("a",{parentName:"p",href:"https://jsonlines.org/"},(0,i.kt)("inlineCode",{parentName:"a"},"jsonl"))," and ",(0,i.kt)("inlineCode",{parentName:"p"},"json"),". Both types will output the results\nusing a random uuid for the filename such as\n",(0,i.kt)("inlineCode",{parentName:"p"},"68330d32-c35e-4d43-8655-1cb5e9d90b83.json")),(0,i.kt)("p",null,"When you run artemis three (3) types of files will be generated:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"<uuuid>.{json or jsonl}")," a unique filename dependent on the format selected.\nThese files contain the artifact data output. Depending on the collection\nmultiple ",(0,i.kt)("inlineCode",{parentName:"li"},"<uuuid>.{json or jsonl}")," files will be created"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"<uuid>.log")," a log file containing any errors or warnings generated by artemis\nduring the collection. Only one (1) per collection will exist"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"status.log")," a log file that maps the ",(0,i.kt)("inlineCode",{parentName:"li"},"<uuuid>.{json or jsonl}")," to an artifact\nname. ",(0,i.kt)("inlineCode",{parentName:"li"},"<uuuid>.{json or jsonl}")," also contains the artifact name. The\n",(0,i.kt)("inlineCode",{parentName:"li"},"status.log")," provides a quick way to see what files contain a specific\nartifact. Only one (1) per collection will exist")),(0,i.kt)("p",null,"The ",(0,i.kt)("inlineCode",{parentName:"p"},"json")," output from the ",(0,i.kt)("inlineCode",{parentName:"p"},"amcache")," TOML collection from the previous page\nwould look like the following:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "metadata": {\n    "endpoint_id": "6c51b123-1522-4572-9f2a-0bd5abd81b82",\n    "id": 1,\n    "uuid": "41bc55e4-bc7b-4798-8808-4351092595a5",\n    "artifact_name": "amcache",\n    "complete_time": 1680466070,\n    "start_time": 1680466065,\n    "hostname": "DESKTOP-UQQDFT8",\n    "os_version": "11 (22000)",\n    "platform": "Windows",\n    "kernel_version": "22000",\n    "load_performance": {\n      "avg_one_min": 0.0,\n      "avg_five_min": 0.0,\n      "avg_fifteen_min": 0.0\n    }\n  },\n  "data": [\n    {\n      "first_execution": 1641252583,\n      "path": "c:\\\\program files (x86)\\\\windows kits\\\\10\\\\debuggers\\\\x86\\\\1394\\\\1394kdbg.sys",\n      "name": "1394kdbg.sys",\n      "original_name": "1394dbg.sys",\n      "version": "10.0.19041.685 (winbuild.160101.0800)",\n      "binary_type": "pe32_i386",\n      "product_version": "10.0.19041.685",\n      "product_name": "microsoft\xae windows\xae operating system",\n      "language": "",\n      "file_id": "",\n      "link_date": "10/28/2087 21:21:59",\n      "path_hash": "1394kdbg.sys|2912931c5988cc06",\n      "program_id": "00a68cd0bda5b35cd2f03e8556cad622f00000904",\n      "size": "38352",\n      "publisher": "microsoft corporation",\n      "usn": "4010442296",\n      "sha1": "",\n      "reg_path": "{11517B7C-E79D-4e20-961B-75A811715ADD}\\\\Root\\\\InventoryApplicationFile\\\\1394kdbg.sys|2912931c5988cc06"\n    }\n  ]\n}\n')),(0,i.kt)("p",null,"All artifacts parsed by artemis will be formatted similar to the output above."),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"metadata")," object that contains metadata about the system. All artifacts will\ncontain a metadata object",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"endpoint_id")," The ID associated with the endpoint. This is from the ",(0,i.kt)("inlineCode",{parentName:"li"},"TOML"),"\ninput"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"id")," The ID associated with the collection. This is from the ",(0,i.kt)("inlineCode",{parentName:"li"},"TOML")," input"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"uuid")," Unique ID associated with the output"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"artifact_name")," The name of the artifact collected. This is from the ",(0,i.kt)("inlineCode",{parentName:"li"},"TOML"),"\ninput"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"complete_time")," The time artemis completed parsing the data"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"start_time")," The time artemis started parsing the data"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"hostname")," The hostname of the endpoint"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"os_version")," Thes OS version of the endpoint"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"platform")," The platform of the endpoint. Ex: Windows or macOS"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"kernel_version")," The kernel version of the endpoint"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"load_performance")," The endpoint performance for one, five, and fifteen\nminutes. On Windows these values are always zero",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"avg_one_min")," Average load performance for one minute"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"avg_five_mine")," Average load performance for five minutes"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"avg_fifteen_min")," Average load performance for fifteen minutes"))))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"data")," object that contains the artifact specific data. See the\n",(0,i.kt)("a",{parentName:"li",href:"/artemis-api/docs/Artifacts/overview"},"artifact")," chapter for output structure for each\nartifact. If you execute JavaScript you can control what the ",(0,i.kt)("inlineCode",{parentName:"li"},"data")," value is.\nFor example you can return a string instead of an object. artemis uses serde\nto serialize the final output")),(0,i.kt)("p",null,"This data would be saved in a ",(0,i.kt)("inlineCode",{parentName:"p"},"<uuid>.json")," file"),(0,i.kt)("p",null,"The ",(0,i.kt)("inlineCode",{parentName:"p"},"jsonl")," output from the ",(0,i.kt)("inlineCode",{parentName:"p"},"amcache")," TOML collection from the previous page\nwould look like the following:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-jsonl"},'{"metadata":{"endpoint_id":"6c51b123-1522-4572-9f2a-0bd5abd81b82","id":1,"artifact_name":"amcache","complete_time":1680467122,"start_time":1680467120,"hostname":"DESKTOP-UQQDFT8","os_version":"11 (22000)","platform":"Windows","kernel_version":"22000","load_performance":{"avg_one_min":0.0,"avg_five_min":0.0,"avg_fifteen_min":0.0},"uuid":"64702816-0f24-4e6e-a72a-118cb51c55b4"},"data":{"first_execution":1641252583,"path":"c:\\\\program files (x86)\\\\windows kits\\\\10\\\\debuggers\\\\x86\\\\1394\\\\1394kdbg.sys","name":"1394kdbg.sys","original_name":"1394dbg.sys","version":"10.0.19041.685 (winbuild.160101.0800)","binary_type":"pe32_i386","product_version":"10.0.19041.685","product_name":"microsoft\xae windows\xae operating system","language":"","file_id":"","link_date":"10/28/2087 21:21:59","path_hash":"1394kdbg.sys|2912931c5988cc06","program_id":"00a68cd0bda5b35cd2f03e8556cad622f00000904","size":"38352","publisher":"microsoft corporation","usn":"4010442296","sha1":"","reg_path":"{11517B7C-E79D-4e20-961B-75A811715ADD}\\\\Root\\\\InventoryApplicationFile\\\\1394kdbg.sys|2912931c5988cc06"}}\n{"metadata":{"endpoint_id":"6c51b123-1522-4572-9f2a-0bd5abd81b82","id":1,"artifact_name":"amcache","complete_time":1680467122,"start_time":1680467120,"hostname":"DESKTOP-UQQDFT8","os_version":"11 (22000)","platform":"Windows","kernel_version":"22000","load_performance":{"avg_one_min":0.0,"avg_five_min":0.0,"avg_fifteen_min":0.0},"uuid":"5afa02eb-1e11-48a0-993e-3bb852667db7"},"data":{"first_execution":1641252583,"path":"c:\\\\program files (x86)\\\\windows kits\\\\10\\\\debuggers\\\\x64\\\\1394\\\\1394kdbg.sys","name":"1394kdbg.sys","original_name":"1394dbg.sys","version":"10.0.19041.685 (winbuild.160101.0800)","binary_type":"pe64_amd64","product_version":"10.0.19041.685","product_name":"microsoft\xae windows\xae operating system","language":"","file_id":"","link_date":"11/30/2005 17:06:22","path_hash":"1394kdbg.sys|7e05880d5bf9d27b","program_id":"00a68cd0bda5b35cd2f03e8556cad622f00000904","size":"47568","publisher":"microsoft corporation","usn":"4010568800","sha1":"","reg_path":"{11517B7C-E79D-4e20-961B-75A811715ADD}\\\\Root\\\\InventoryApplicationFile\\\\1394kdbg.sys|7e05880d5bf9d27b"}}\n...\n{"metadata":{"endpoint_id":"6c51b123-1522-4572-9f2a-0bd5abd81b82","id":1,"artifact_name":"amcache","complete_time":1680467122,"start_time":1680467120,"hostname":"DESKTOP-UQQDFT8","os_version":"11 (22000)","platform":"Windows","kernel_version":"22000","load_performance":{"avg_one_min":0.0,"avg_five_min":0.0,"avg_fifteen_min":0.0},"uuid":"bce5fccc-9f13-40cd-bebd-95a32ead119a"},"data":{"first_execution":1641252542,"path":"c:\\\\program files\\\\git\\\\mingw64\\\\bin\\\\ziptool.exe","name":"ziptool.exe","original_name":"","version":"","binary_type":"pe64_amd64","product_version":"","product_name":"","language":"","file_id":"","link_date":"01/01/1970 00:00:00","path_hash":"ziptool.exe|7269435f129e6e01","program_id":"01286cf3cc5f1d161abf355f10fee583c0000ffff","size":"162258","publisher":"","usn":"3869400664","sha1":"","reg_path":"{11517B7C-E79D-4e20-961B-75A811715ADD}\\\\Root\\\\InventoryApplicationFile\\\\ziptool.exe|7269435f129e6e01"}}\n{"metadata":{"endpoint_id":"6c51b123-1522-4572-9f2a-0bd5abd81b82","id":1,"artifact_name":"amcache","complete_time":1680467122,"start_time":1680467120,"hostname":"DESKTOP-UQQDFT8","os_version":"11 (22000)","platform":"Windows","kernel_version":"22000","load_performance":{"avg_one_min":0.0,"avg_five_min":0.0,"avg_fifteen_min":0.0},"uuid":"8437907f-53a4-43a2-8ff4-22acb3d06d72"},"data":{"first_execution":1641252542,"path":"c:\\\\program files\\\\git\\\\usr\\\\bin\\\\[.exe","name":"[.exe","original_name":"","version":"","binary_type":"pe64_amd64","product_version":"","product_name":"","language":"","file_id":"","link_date":"01/01/1970 00:00:00","path_hash":"[.exe|b6eac39997c90239","program_id":"01286cf3cc5f1d161abf355f10fee583c0000ffff","size":"68322","publisher":"","usn":"3870610520","sha1":"","reg_path":"{11517B7C-E79D-4e20-961B-75A811715ADD}\\\\Root\\\\InventoryApplicationFile\\\\[.exe|b6eac39997c90239"}}\n')),(0,i.kt)("p",null,"The ",(0,i.kt)("inlineCode",{parentName:"p"},"jsonl")," output is identical to ",(0,i.kt)("inlineCode",{parentName:"p"},"json")," with the following differences:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"The values in ",(0,i.kt)("inlineCode",{parentName:"li"},"data")," are split into separate lines instead of an array"),(0,i.kt)("li",{parentName:"ul"},"The ",(0,i.kt)("inlineCode",{parentName:"li"},"uuid")," is unique for each ",(0,i.kt)("inlineCode",{parentName:"li"},"json")," line")),(0,i.kt)("p",null,"This data would be saved in a ",(0,i.kt)("inlineCode",{parentName:"p"},"<uuid>.jsonl")," file"),(0,i.kt)("p",null,"The ",(0,i.kt)("inlineCode",{parentName:"p"},"<uuid>.log")," output from a collection contains any errors or warnings\nencountered during the collection."),(0,i.kt)("p",null,"The ",(0,i.kt)("inlineCode",{parentName:"p"},"status.log")," output from a collection maps the ",(0,i.kt)("inlineCode",{parentName:"p"},"<uuuid>.{json or jsonl}")," to\nan artifact name. A possible example from the macOS ",(0,i.kt)("inlineCode",{parentName:"p"},"UnifiedLogs")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"unifiedlogs:d45221df-349b-4467-b726-a9446865b259.json\nunifiedlogs:eccd7b5b-4941-4134-a790-b073eb992188.json\n")),(0,i.kt)("p",null,"As mentioned and seen above you can also check the actual\n",(0,i.kt)("inlineCode",{parentName:"p"},"<uuid>.{json or jsonl}")," files to find the ",(0,i.kt)("inlineCode",{parentName:"p"},"artifact_name")),(0,i.kt)("h1",{id:"compression"},"Compression"),(0,i.kt)("p",null,"If you choose to enable compression for the output artemis will compress each\n",(0,i.kt)("inlineCode",{parentName:"p"},"<uuid>.{json or jsonl}")," using ",(0,i.kt)("inlineCode",{parentName:"p"},"gzip")," compression. The files will be saved as\n",(0,i.kt)("inlineCode",{parentName:"p"},"<uuid>.{json or jsonl}.gz"),". The log files are not compressed."),(0,i.kt)("p",null,"Once the collection is complete artemis will compress the whole output directory\ninto a ",(0,i.kt)("inlineCode",{parentName:"p"},"zip")," file and remove the output directory. Leaving only the ",(0,i.kt)("inlineCode",{parentName:"p"},"zip")," file."),(0,i.kt)("p",null,"Since artemis is running using elevated privileges it uses a cautious approach\nto deleting its data:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"It gets a list of files in its output directory and deletes files one at a\ntime that end in: json, jsonl, gz, or log"),(0,i.kt)("li",{parentName:"ul"},"Once all output files are deleted, it will delete the empty directory.")))}c.isMDXComponent=!0}}]);