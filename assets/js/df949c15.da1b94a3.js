"use strict";(self.webpackChunkartemis_docs=self.webpackChunkartemis_docs||[]).push([[7776],{25386:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>a,default:()=>h,frontMatter:()=>o,metadata:()=>i,toc:()=>l});const i=JSON.parse('{"id":"Intro/Collections/format","title":"Format","description":"The TOML collection format","source":"@site/docs/Intro/Collections/format.md","sourceDirName":"Intro/Collections","slug":"/Intro/Collections/format","permalink":"/artemis-api/docs/Intro/Collections/format","draft":false,"unlisted":false,"editUrl":"https://github.com/puffyCid/artemis-api/tree/main/artemis-docs/docs/Intro/Collections/format.md","tags":[],"version":"current","lastUpdatedBy":"puffyCid","lastUpdatedAt":1743403591000,"sidebarPosition":2,"frontMatter":{"sidebar_position":2,"description":"The TOML collection format"},"sidebar":"artemisStart","previous":{"title":"Overview","permalink":"/artemis-api/docs/Intro/Collections/overview"},"next":{"title":"Output Formats","permalink":"/artemis-api/docs/Intro/Collections/output"}}');var s=n(74848),r=n(28453);const o={sidebar_position:2,description:"The TOML collection format"},a="Format",c={},l=[];function d(e){const t={a:"a",br:"br",code:"code",h1:"h1",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.header,{children:(0,s.jsx)(t.h1,{id:"format",children:"Format"})}),"\n",(0,s.jsx)(t.p,{children:"An example TOML collection is provided below:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-toml",children:'system = "windows"\n\n[output]\nname = "amcache_collection"\ndirectory = "./tmp"\nformat = "json"\ncompress = false\ntimeline = false\nendpoint_id = "6c51b123-1522-4572-9f2a-0bd5abd81b82"\ncollection_id = 1\noutput = "local"\nurl = ""\napi_key = ""\nfilter_name = ""\nfilter_script = ""\nlogging = "warn"\n\n[[artifacts]]\nartifact_name = "amcache"\nfilter = false\n[artifacts.amcache]\n# Optional\n# alt_file = "C:\\\\Artifacts\\\\Amcache.hve"\n'})}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"system"})," Defines what OS this collection targets. This example targets Windows\nsystems. This collection will only run with the Windows version of artemis"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"[output]"})," Defines the output configuration","\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"name"})," The output name. This can be any string value"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"directory"})," The directory where the output should be written. This example\noutputs to a directory called tmp in the current working directory"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"format"})," The output format can be either json or jsonl or csv"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"compress"})," Whether to compress the output with ",(0,s.jsx)(t.strong,{children:"gzip"})," compression. Once\nthe collection is complete the output directory will be compressed with\n",(0,s.jsx)(t.strong,{children:"zip"})," compression."]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"timeline"})," Whether to timeline the parsed data. This forces the output format to JSONL and is compatible with ",(0,s.jsx)(t.a,{href:"https://timesketch.org/",children:"Timesketch"})]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"endpoint_id"})," An ID assigned to the endpoint. This can be any string value"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"collection_id"})," A number assigned to the collection. This can be any postive\nnumber"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"output"})," The output type. Values can be: ",(0,s.jsx)(t.strong,{children:"local"}),", ",(0,s.jsx)(t.strong,{children:"aws"}),", ",(0,s.jsx)(t.strong,{children:"gcp"}),", or\n",(0,s.jsx)(t.strong,{children:"azure"})]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"url"})," The URL associated with either aws, gcp, or azure. This is required\nonly if using ",(0,s.jsx)(t.strong,{children:"remote upload"})," output"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"api_key"})," The API key associated with either aws, gcp, or azure. This is\nrequired only if using ",(0,s.jsx)(t.strong,{children:"remote upload"})," output"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"filter_name"})," The name of the provided filter_script. This is ",(0,s.jsx)(t.strong,{children:"optional"}),"\nbut if you are using a filter_script you should provide a name. Otherwise\nthe default name ",(0,s.jsx)(t.strong,{children:"UnknownFilterName"})," is used"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"filter_script"})," An advanced ",(0,s.jsx)(t.strong,{children:"optional"})," output option. Artemis will pass\nthe results of each ",(0,s.jsx)(t.strong,{children:"[[artifacts]]"})," entry into a script. See\n",(0,s.jsx)(t.a,{href:"/artemis-api/docs/Intro/Scripting/boa",children:"scripting"})," section for detailed overview of this\noption."]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"logging"})," Set the logging level for artemis. This is ",(0,s.jsx)(t.strong,{children:"optional"})," by default\nartemis will log errors and warnings. Valid options are: ",(0,s.jsx)(t.strong,{children:"warn"}),",\n",(0,s.jsx)(t.strong,{children:"error"}),", ",(0,s.jsx)(t.strong,{children:"debug"}),", or ",(0,s.jsx)(t.strong,{children:"info"})]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"[[artifacts]]"})," A list of artifacts to collect","\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"artifact_name"})," Name of aritfact"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"filter"})," Whether to filter the artifact data through the filter_script. This\nis ",(0,s.jsx)(t.strong,{children:"optional"})," by default nothing is filtered. This option will send\nartifact results to your provided filter_script"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"[aritfacts.amcache]"})," Artifact configuration parameters","\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"alt_file"})," Use an alternative amcache file when collecting data. This\nconfiguration is ",(0,s.jsx)(t.strong,{children:"optional"})]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(t.p,{children:"The example above collects one artifact (Amcache) on a Windows system and\noutputs the results the local system at the path ./tmp/amcache_collection"}),"\n",(0,s.jsx)(t.p,{children:"If we wanted to collect more than one artifact we could use a collection like\nthe one below:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-toml",children:'system = "windows"\n\n[output]\nname = "execution_collection"\ndirectory = "./tmp"\nformat = "jsonl"\ncompress = false\ntimeline = true\nendpoint_id = "6c51b123-1522-4572-9f2a-0bd5abd81b82"\ncollection_id = 1\noutput = "local"\n\n[[artifacts]]\nartifact_name = "amcache"\n[artifacts.amcache]\n\n[[artifacts]]\nartifact_name = "shortcuts"\n[artifacts.shortcuts]\npath = "C:\\\\ProgramData\\\\Microsoft\\\\Windows\\\\Start Menu\\\\Programs\\\\Startup"\n'})}),"\n",(0,s.jsxs)(t.p,{children:["The TOML collection above collects both ",(0,s.jsx)(t.code,{children:"amcache"})," and ",(0,s.jsx)(t.code,{children:"shortcuts"})," data on a\nWindows system and outputs the results to the local system at the path\n./tmp/execution_collection."]}),"\n",(0,s.jsxs)(t.p,{children:["Notable changes:",(0,s.jsx)(t.br,{}),"\n",(0,s.jsx)(t.strong,{children:"name"})," our collection is now named ",(0,s.jsx)(t.code,{children:"execution_collection"})]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-toml",children:'[[artifacts]]\nartifact_name = "amcache"\n[artifacts.amcache]\n'})}),"\n",(0,s.jsxs)(t.p,{children:["Since the ",(0,s.jsx)(t.code,{children:"alt_drive"})," parameter is optional for ",(0,s.jsx)(t.strong,{children:"amcache"})," we do not need to\nspecifiy it"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-toml",children:'[[artifacts]]\nartifact_name = "shortcuts"\n[artifacts.shortcuts]\npath = "C:\\\\ProgramData\\\\Microsoft\\\\Windows\\\\Start Menu\\\\Programs\\\\Startup"\n'})}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"[[artifacts]]"})," The second entry in our list of artifacts to collect","\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"artifact_name"})," Name of aritfact"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"[aritfacts.shortcuts]"})," Artifact configuration parameters","\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"path"})," Use the provided path to collect ",(0,s.jsx)(t.strong,{children:"shortcuts"})," data. This\nparameter is ",(0,s.jsx)(t.strong,{children:"required"})]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(t.p,{children:["Since ",(0,s.jsx)(t.code,{children:"[[artifacts]]"})," is a list we can even provide the same artifact multiple\ntimes:"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-toml",children:'[[artifacts]]\nartifact_name = "shortcuts"\n[artifacts.shortcuts]\npath = "C:\\\\ProgramData\\\\Microsoft\\\\Windows\\\\Start Menu\\\\Programs\\\\Startup"\n\n[[artifacts]]\nartifact_name = "shortcuts"\n[artifacts.shortcuts]\npath = "D:\\\\ProgramData\\\\Microsoft\\\\Windows\\\\Start Menu\\\\Programs\\\\Startup"\n\n[[artifacts]]\nartifact_name = "shortcuts"\n[artifacts.shortcuts]\npath = "E:\\\\Users\\\\rust\\\\Downloads"\n'})}),"\n",(0,s.jsxs)(t.p,{children:["However, providing the same artifact mutliple times can be repetitive. See the\nchapter on ",(0,s.jsx)(t.a,{href:"/artemis-api/docs/Intro/Scripting/boa",children:"scripting"})," to see how we can automate and\nenhance artifact collection using artemis and a tiny amount of JavaScript!"]}),"\n",(0,s.jsxs)(t.p,{children:["Finally you can review the full list of all supported artifacts and their\nconfiguration under the ",(0,s.jsx)(t.a,{href:"/artemis-api/docs/Artifacts/overview",children:"artifact"})," chapter"]})]})}function h(e={}){const{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},28453:(e,t,n)=>{n.d(t,{R:()=>o,x:()=>a});var i=n(96540);const s={},r=i.createContext(s);function o(e){const t=i.useContext(r);return i.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),i.createElement(r.Provider,{value:t},e.children)}}}]);