"use strict";(self.webpackChunkartemis_docs=self.webpackChunkartemis_docs||[]).push([[3380],{9812:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>a,default:()=>l,frontMatter:()=>r,metadata:()=>o,toc:()=>m});var i=n(7624),s=n(2172);const r={description:"Timelining artifacts"},a="Timelines",o={id:"API/API Scenarios/timelines",title:"Timelines",description:"Timelining artifacts",source:"@site/docs/API/API Scenarios/timelines.md",sourceDirName:"API/API Scenarios",slug:"/API/API Scenarios/timelines",permalink:"/artemis-api/docs/API/API Scenarios/timelines",draft:!1,unlisted:!1,editUrl:"https://github.com/puffyCid/artemis-api/tree/main/artemis-docs/docs/API/API Scenarios/timelines.md",tags:[],version:"current",lastUpdatedBy:"puffyCid",lastUpdatedAt:1715224196e3,frontMatter:{description:"Timelining artifacts"},sidebar:"artemisAPI",previous:{title:"Acquiring Files",permalink:"/artemis-api/docs/API/API Scenarios/acquire_files"},next:{title:"Timesketch",permalink:"/artemis-api/docs/API/API Scenarios/timesketch"}},c={},m=[];function d(e){const t={a:"a",code:"code",h1:"h1",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",...(0,s.M)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.h1,{id:"timelines",children:"Timelines"}),"\n",(0,i.jsxs)(t.p,{children:["Using the artemis API you may timeline artifacts into a standard JSONL (or JSON)\nformat. Artemis uses the timeline format based on\n",(0,i.jsx)(t.a,{href:"https://timesketch.org/",children:"Timesketch"}),"."]}),"\n",(0,i.jsx)(t.p,{children:"The format is defind below:"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-typescript",children:"export interface TimesketchTimeline {\n  /** **Required by Timeskech** ISO8601 timestamp format: YYYY-MM-DD HH:mm:ss. All times are in UTC */\n  datetime: string;\n  /** **Required by Timeskech** Description of the timestamp. Ex: FileCreated */\n  timestamp_desc: string;\n  /** **Required by Timeskech** Timeline message data */\n  message: string;\n  /**The type of artifact that was timelined */\n  artifact: string;\n  /**\n   * Artifact data type. Based on plaso definition\n   * (its kind of freeform, https://github.com/log2timeline/plaso/blob/main/docs/sources/user/Scribbles-about-events.md).\n   * Looks like: `source:artifact:artifact:data`. With first artifact most generic and second one more specific\n   * :artifact: can be nested. Ex: `windows:registry:explorer:programcache`\n   */\n  data_type: string;\n  /**Include any other valid JSON data */\n  [key: string]: unknown;\n}\n"})}),"\n",(0,i.jsxs)(t.p,{children:["The API function ",(0,i.jsx)(t.strong,{children:"timelineArtifact"})," can be used to timeline supported\nartifacts. You can also timeline your own custom artifacts, you just need to\nensure the output follows ",(0,i.jsx)(t.strong,{children:"TimesketchTimeline"})," object above."]}),"\n",(0,i.jsx)(t.p,{children:"A sample script below shows how to timeline launchdaemon data."}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-typescript",children:'import { dumpData, getLaunchdDaemons } from "../../Projects/artemis-api/mod.ts";\nimport { MacosError } from "../../Projects/artemis-api/src/macos/errors.ts";\nimport {\n  Format,\n  Output,\n  OutputType,\n} from "../../Projects/artemis-api/src/system/output.ts";\n\nimport { TimesketchError } from "../../Projects/artemis-api/src/timesketch/error.ts";\nimport { timelineArtifact } from "../../Projects/artemis-api/src/timesketch/timeline.ts";\nimport { TimesketchArtifact } from "../../Projects/artemis-api/types/timesketch/timeline.ts";\n\nfunction main() {\n  const out: Output = {\n    name: "launchd",\n    directory: "./tmp",\n    format: Format.JSONL,\n    compress: false,\n    endpoint_id: "abc",\n    collection_id: 0,\n    output: OutputType.LOCAL,\n  };\n\n  const daemons = getLaunchdDaemons();\n  if (daemons instanceof MacosError) {\n    return;\n  }\n\n  const results = timelineArtifact(daemons, TimesketchArtifact.LAUNCHD);\n  if (status instanceof TimesketchError) {\n    return;\n  }\n  dumpData(JSON.stringify(results), "launchd", out);\n}\n\nmain();\n'})}),"\n",(0,i.jsx)(t.p,{children:"A quick walkthrough for this script:"}),"\n",(0,i.jsxs)(t.ol,{children:["\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.code,{children:"Output"})," define our output object as documented in\n",(0,i.jsx)(t.a,{href:"/artemis-api/docs/Intro/Collections/format",children:"format documentation"})]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.code,{children:"getLaunchdDaemons()"})," parse macOS launchDaemons"]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.code,{children:"timelineArtifact(daemons, TimesketchArtifact.LAUNCHD)"})," timeline our parsed\nlaunchDaemons"]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.code,{children:'dumpData(JSON.stringify(results), "launchd", out)'})," Dump the raw JSONL data\nto a file. This will skip the metadata that artemis adds to artifact output"]}),"\n"]})]})}function l(e={}){const{wrapper:t}={...(0,s.M)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},2172:(e,t,n)=>{n.d(t,{I:()=>o,M:()=>a});var i=n(1504);const s={},r=i.createContext(s);function a(e){const t=i.useContext(r);return i.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),i.createElement(r.Provider,{value:t},e.children)}}}]);