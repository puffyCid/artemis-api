"use strict";(self.webpackChunkartemis_docs=self.webpackChunkartemis_docs||[]).push([[4988],{3748:(t,n,e)=>{e.r(n),e.d(n,{assets:()=>s,contentTitle:()=>o,default:()=>d,frontMatter:()=>r,metadata:()=>l,toc:()=>u});var i=e(7624),a=e(2172);const r={description:"The macOS Spotlight database",keywords:["macOS","file meta","binary"]},o="Spotlight",l={id:"Artifacts/macOS Artifacts/spotlight",title:"Spotlight",description:"The macOS Spotlight database",source:"@site/docs/Artifacts/macOS Artifacts/spotlight.md",sourceDirName:"Artifacts/macOS Artifacts",slug:"/Artifacts/macOS Artifacts/spotlight",permalink:"/artemis-api/docs/Artifacts/macOS Artifacts/spotlight",draft:!1,unlisted:!1,editUrl:"https://github.com/puffyCid/artemis-api/tree/main/artemis-docs/docs/Artifacts/macOS Artifacts/spotlight.md",tags:[],version:"current",lastUpdatedBy:"puffyCid",lastUpdatedAt:1717296902e3,frontMatter:{description:"The macOS Spotlight database",keywords:["macOS","file meta","binary"]},sidebar:"artemisArtifacts",previous:{title:"Shell History",permalink:"/artemis-api/docs/Artifacts/macOS Artifacts/shellhistory"},next:{title:"Sudo Logs",permalink:"/artemis-api/docs/Artifacts/macOS Artifacts/sudo"}},s={},u=[];function c(t){const n={a:"a",br:"br",code:"code",h1:"h1",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,a.M)(),...t.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h1,{id:"spotlight",children:"Spotlight"}),"\n",(0,i.jsxs)(n.p,{children:["macOS ",(0,i.jsx)(n.code,{children:"Spotlight"})," is an indexing service for tracking files and content. The\n",(0,i.jsx)(n.code,{children:"Spotlight"})," database can contain a huge amount of metadata associated with the\nindexed content such as:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Timestamps"}),"\n",(0,i.jsx)(n.li,{children:"Partial file content"}),"\n",(0,i.jsx)(n.li,{children:"File type and much more"}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["The primary database is typically located at the root of the macOS Data volume.",(0,i.jsx)(n.br,{}),"\n","ex: /System/Volumes/Data/.Spotlight-V100/Store-V3/123-445566-778-12384/"]}),"\n",(0,i.jsx)(n.p,{children:"By default artemis will only attempt to parse the Spotlight database located at\nthe Data volume"}),"\n",(0,i.jsx)(n.p,{children:"However, additional databases can also be found on the macOS system. Known\nadditional locations are:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"/Users/*/Library/Caches/com.apple.helpd/index.spotlightV*/*"}),"\n",(0,i.jsx)(n.li,{children:"/Users/*/Library/Metadata/CoreSpotlight/index.spotlightV*/*"}),"\n",(0,i.jsx)(n.li,{children:"/Users/*/Library/Developer/Xcode/DocumentationCache/*/*/DeveloperDocumentation.index/*"}),"\n",(0,i.jsx)(n.li,{children:"/Users/*/Library/Metadata/CoreSpotlight/*/index.spotlightV*/*"}),"\n",(0,i.jsx)(n.li,{children:"/Users/*/Library/Caches/com.apple.helpd/*/index.spotlightV*/*"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Similar to the filelisting artifact, every 10k entries artemis will output the\ndata and continue."}),"\n",(0,i.jsx)(n.p,{children:"Other Parsers:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://github.com/ydkhatri/spotlight_parser",children:"spotlight_parser"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://github.com/ydkhatri/mac_apt",children:"mac_apt"})}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"References:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://forensicsandsecurity.com/papers/SpotlightMacForensicsSlides.pdf",children:"Forensic and Security"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://en.wikipedia.org/wiki/Spotlight_(Apple)",children:"Spotlight"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://github.com/libyal/dtformats/blob/main/documentation/Apple%20Spotlight%20store%20database%20file%20format.asciidoc",children:"libyal"})}),"\n"]}),"\n",(0,i.jsx)(n.h1,{id:"toml-collection",children:"TOML Collection"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-toml",children:'system = "macos"\n\n[output]\nname = "spotlight_collection"\ndirectory = "./tmp"\nformat = "jsonl"\ncompress = false\nendpoint_id = "abdc"\ncollection_id = 1\noutput = "local"\n\n[[artifacts]]\nartifact_name = "spotlight"\n[artifacts.spotlight]\n# Optional\n# alt_path = ""\n\n# Include additional known Spotlight paths such as\n#     /Users/*/Library/Caches/com.apple.helpd/index.spotlightV*/*\n#     /Users/*/Library/Metadata/CoreSpotlight/index.spotlightV*/*\n#     /Users/*/Library/Developer/Xcode/DocumentationCache/*/*/DeveloperDocumentation.index/*\n#     /Users/*/Library/Metadata/CoreSpotlight/*/index.spotlightV*/*\n#     /Users/*/Library/Caches/com.apple.helpd/*/index.spotlightV*/*\n# This is optional. Default is false\ninclude_additional = true\n'})}),"\n",(0,i.jsx)(n.h1,{id:"collection-options",children:"Collection Options"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"alt_path"})," Alternative path to a Spotlight database. This configuration is\n",(0,i.jsx)(n.strong,{children:"optional"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"include_additional"})," Artemis will parse additional known Spotlight database\nlocations. This configuration is ",(0,i.jsx)(n.strong,{children:"optional"})]}),"\n"]}),"\n",(0,i.jsx)(n.h1,{id:"output-structure",children:"Output Structure"}),"\n",(0,i.jsxs)(n.p,{children:["An array of ",(0,i.jsx)(n.code,{children:"Spotlight"})," entries"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:'export interface Spotlight {\n  /**Inode number associated with indexed file */\n  inode: bigint;\n  /**Parent inode associated with indexed file */\n  parent_inode: bigint;\n  /**Flags associated with indexed entry */\n  flags: number;\n  /**Store ID associated with indexed entry */\n  store_id: number;\n  /**Last time Spotlight entry was updated in UNIXEPOCH **microseconds** */\n  last_updated: bigint;\n  /**\n   *  Properties associated with the entry\n   *\n   * * Example:\n   * ```\n   * "values": {\n        "kMDItemContentTypeTree": {\n            "attribute": "AttrList",\n            "value": [\n                "public.item",\n                "dyn.ah62d4rv4ge81g75mq34gk55d",\n                "public.data"\n            ]\n        },\n        "_kMDItemFileName": {\n            "attribute": "AttrString",\n            "value": "arm64e-apple-ios-macabi.swiftdoc"\n        },\n        "kMDItemContentCreationDate_Ranking": {\n            "attribute": "AttrDate",\n            "value": [\n                1619308800\n            ]\n        },\n        "kMDItemPhysicalSize": {\n            "attribute": "AttrVariableSizeIntMultiValue",\n            "value": [\n                77824\n            ]\n        },\n        "_kMDItemDisplayNameWithExtensions": {\n            "attribute": "AttrString",\n            "value": "arm64e-apple-ios-macabi.swiftdoc\\u0016\\u0002"\n        },\n        "_kMDItemTypeCode": {\n            "attribute": "AttrVariableSizeIntMultiValue",\n            "value": [\n                0\n            ]\n        },\n        "_kMDItemCreationDate": {\n            "attribute": "AttrDate",\n            "value": [\n                1619320292\n            ]\n        },\n        "kMDItemSupportFileType": {\n            "attribute": "AttrList",\n            "value": [\n                "MDSystemFile"\n            ]\n        },\n        "_kMDItemFinderLabel": {\n            "attribute": "AttrVariableSizeIntMultiValue",\n            "value": [\n                0\n            ]\n        },\n        "kMDItemInterestingDate_Ranking": {\n            "attribute": "AttrDate",\n            "value": [\n                1619308800\n            ]\n        },\n        "kMDItemKind": {\n            "attribute": "AttrList",\n            "value": [\n                "Document\\u0016\\u0002",\n                "\u0627\u0644\u0645\u0633\u062a\u0646\u062f\\u0016\\u0002ar",\n                "Document\\u0016\\u0002ca",\n                "Dokument\\u0016\\u0002cs",\n                "Dokument\\u0016\\u0002da",\n                "Dokument\\u0016\\u0002de",\n                "\u0395\u0301\u03b3\u03b3\u03c1\u03b1\u03c6\u03bf\\u0016\\u0002el",\n                "Document\\u0016\\u0002en",\n                "Document\\u0016\\u0002en_AU",\n                "Document\\u0016\\u0002en_GB",\n                "Documento\\u0016\\u0002es",\n                "Documento\\u0016\\u0002es_419",\n                "Dokumentti\\u0016\\u0002fi",\n                "Document\\u0016\\u0002fr",\n                "Document\\u0016\\u0002fr_CA",\n                "\u05de\u05e1\u05de\u05da\\u0016\\u0002he",\n                "\u0926\u0938\u094d\u0924\u093e\u0935\u0947\u091c\u093c\\u0016\\u0002hi",\n                "Dokument\\u0016\\u0002hr",\n                "Dokumentum\\u0016\\u0002hu",\n                "Dokumen\\u0016\\u0002id",\n                "Documento\\u0016\\u0002it",\n                "\u66f8\u985e\\u0016\\u0002ja",\n                "\u1106\u116e\u11ab\u1109\u1165\\u0016\\u0002ko",\n                "Dokumen\\u0016\\u0002ms",\n                "Document\\u0016\\u0002nl",\n                "Dokument\\u0016\\u0002no",\n                "dokument\\u0016\\u0002pl",\n                "Documento\\u0016\\u0002pt",\n                "Documento\\u0016\\u0002pt_PT",\n                "Document\\u0016\\u0002ro",\n                "\u0414\u043e\u043a\u0443\u043c\u0435\u043d\u0442\\u0016\\u0002ru",\n                "Dokument\\u0016\\u0002sk",\n                "Dokument\\u0016\\u0002sv",\n                "\u0e40\u0e2d\u0e01\u0e2a\u0e32\u0e23\\u0016\\u0002th",\n                "Belge\\u0016\\u0002tr",\n                "\u0414\u043e\u043a\u0443\u043c\u0435\u043d\u0442\\u0016\\u0002uk",\n                "Ta\u0300i lie\u0323\u0302u\\u0016\\u0002vi",\n                "\u6587\u7a3f\\u0016\\u0002zh_CN",\n                "\u6587\u4ef6\\u0016\\u0002zh_HK",\n                "\u6587\u4ef6\\u0016\\u0002zh_TW"\n            ]\n        },\n        "kMDItemContentCreationDate": {\n            "attribute": "AttrDate",\n            "value": [\n                1619320292\n            ]\n        },\n        "_kMDItemInterestingDate": {\n            "attribute": "AttrDate",\n            "value": [\n                1619320292\n            ]\n        },\n        "kMDItemDateAdded": {\n            "attribute": "AttrDate",\n            "value": [\n                1642305054\n            ]\n        },\n        "_kMDItemContentChangeDate": {\n            "attribute": "AttrDate",\n            "value": [\n                1619320292\n            ]\n        },\n        "kMDItemDisplayName": {\n            "attribute": "AttrString",\n            "value": "arm64e-apple-ios-macabi.swiftdoc\\u0016\\u0002"\n        },\n        "kMDItemContentModificationDate": {\n            "attribute": "AttrDate",\n            "value": [\n                1619320292\n            ]\n        },\n        "_kMDItemGroupId": {\n            "attribute": "AttrVariableSizeInt",\n            "value": 18\n        },\n        "kMDItemContentModificationDate_Ranking": {\n            "attribute": "AttrDate",\n            "value": [\n                1619308800\n            ]\n        },\n        "_kMDItemFinderFlags": {\n            "attribute": "AttrVariableSizeIntMultiValue",\n            "value": [\n                0\n            ]\n        },\n        "kMDItemDateAdded_Ranking": {\n            "attribute": "AttrDate",\n            "value": [\n                1642291200\n            ]\n        },\n        "_kMDItemOwnerGroupID": {\n            "attribute": "AttrVariableSizeIntMultiValue",\n            "value": [\n                0\n            ]\n        },\n        "kMDItemContentType": {\n            "attribute": "AttrList",\n            "value": "dyn.ah62d4rv4ge81g75mq34gk55d"\n        },\n        "kMDItemDocumentIdentifier": {\n            "attribute": "AttrVariableSizeIntMultiValue",\n            "value": [\n                0\n            ]\n        },\n        "kMDItemLogicalSize": {\n            "attribute": "AttrVariableSizeIntMultiValue",\n            "value": [\n                218460\n            ]\n        },\n        "_kMDItemOwnerUserID": {\n            "attribute": "AttrVariableSizeIntMultiValue",\n            "value": [\n                0\n            ]\n        },\n        "_kMDItemCreatorCode": {\n            "attribute": "AttrVariableSizeIntMultiValue",\n            "value": [\n                0\n            ]\n        },\n        "_kMDItemIsExtensionHidden": {\n            "attribute": "AttrBool",\n            "value": false\n        }\n    }\n   * ```\n   */\n  values: Record<string, SpotlightProperties>;\n  /**Location of the Spotlight database that was parsed */\n  directory: string;\n}\n\n/**\n * Properties associated with the indexed entry\n */\ninterface SpotlightProperties {\n  /**\n   * Attribute type associated with the entry.\n   * Possible options are:\n   * - AttrBool\n   * - AttrUnknown\n   * - AttrVariableSizeInt\n   * - AttrUnknown2\n   * - AttrUnknown3\n   * - AttrUnknown4\n   * - AttrVariableSizeInt2\n   * - AttrVariableSizeIntMultiValue\n   * - AttrByte\n   * - AttrFloat32\n   * - AttrFloat64\n   * - AttrString\n   * - AttrDate (typically will be number of seconds in UNIXEPOCH)\n   * - AttrBinary\n   * - AttrList\n   * - Unknown\n   */\n  attribute: DataAttribute;\n  /**\n   * Data associated with the property. Type can be determined based on the attribute.\n   * **Important** `value` may also be an array containting data associated with the `attribute`\n   */\n  value: unknown;\n}\n\n/**\n * All possible Attribute types\n */\nenum DataAttribute {\n  /**Boolean value */\n  AttrBool = "AttrBool",\n  /**This attribute is undocumented */\n  AttrUnknown = "AttrUnknown",\n  /**A value of variable size */\n  AttrVariableSizeInt = "AttrVariableSizeInt",\n  /**This attribute is undocumented */\n  AttrUnknown2 = "AttrUnknown2",\n  /**This attribute is undocumented */\n  AttrUnknown3 = "AttrUnknown3",\n  /**This attribute is undocumented */\n  AttrUnknown4 = "AttrUnknown4",\n  /**A value of variable size */\n  AttrVariableSizeInt2 = "AttrVariableSizeInt2",\n  /**A value of variable size (it may be in an array) */\n  AttrVariableSizeIntMultiValue = "AttrVariableSizeIntMultiValue",\n  /**A value with a size of one byte */\n  AttrByte = "AttrByte",\n  /**A 32-bit float value */\n  AttrFloat32 = "AttrFloat32",\n  /**A 64-bit float value */\n  AttrFloat64 = "AttrFloat64",\n  /**A string value */\n  AttrString = "AttrString",\n  /**A date value in seconds in UNIXEPOCH */\n  AttrDate = "AttrDate",\n  /**Base64 encoded binary value. (Depending on the property this may actually be a normal string value (similar to `AttrString`) */\n  AttrBinary = "AttrBinary",\n  /**An array of values */\n  AttrList = "AttrList",\n  /**Artemis failed to determine the attribute */\n  Unknown = "Unknown",\n}\n'})})]})}function d(t={}){const{wrapper:n}={...(0,a.M)(),...t.components};return n?(0,i.jsx)(n,{...t,children:(0,i.jsx)(c,{...t})}):c(t)}},2172:(t,n,e)=>{e.d(n,{I:()=>l,M:()=>o});var i=e(1504);const a={},r=i.createContext(a);function o(t){const n=i.useContext(r);return i.useMemo((function(){return"function"==typeof t?t(n):{...n,...t}}),[n,t])}function l(t){let n;return n=t.disableParentContext?"function"==typeof t.components?t.components(a):t.components||a:o(t.components),i.createElement(r.Provider,{value:n},t.children)}}}]);